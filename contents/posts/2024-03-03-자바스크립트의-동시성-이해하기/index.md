---
title: "Promise.allì˜ ë™ì‹œì„± ì´í•´í•˜ê¸°"
date: 2024-03-03
slug: ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜-ë™ì‹œì„±-ì´í•´í•˜ê¸°
tags: [javascript, ì„±ëŠ¥]
---

## ğŸ™„ ìë°”ìŠ¤í¬ë¦½íŠ¸ê°€ ë³‘ë ¬ì²˜ë¦¬?
ì•„ë§ˆ ì‘ë…„ ë§ë¶€í„° 2ì›”ê¹Œì§€ ì‘ì—…í–ˆë˜ ì‘ì—… ì¤‘ ê°€ì¥ ë§ì´ í•œ ì‘ì—… ì¤‘ í•˜ë‚˜ê°€ ìˆœì°¨ì ìœ¼ë¡œ ì§„í–‰ë˜ëŠ” ë¹„ë™ê¸° ì½”ë“œë¥¼ Promise.all()ì„ ì´ìš©í•´ í•œë²ˆì— ë™ì‘í•  ìˆ˜ ìˆê²Œ ìµœì í™”í•˜ëŠ” ì‘ì—…ì´ì—ˆë‹¤. 
ì‚¬ëŒë“¤ì—ê²Œ ë§í•  ë•ŒëŠ” `ë³‘ë ¬ì²˜ë¦¬`ë¼ê³  í‘œí˜„í•˜ê³¤ í–ˆì§€ë§Œ ë‚´ì•ˆì— ì–´ìƒ‰í•¨ì´ ëŠê»´ì¡Œë‹¤. `ìë°”ìŠ¤í¬ë¦½íŠ¸ëŠ” ì‹±ê¸€ìŠ¤ë ˆë“œ ì–¸ì–´ì¸ë° ì–´ë–»ê²Œ ì—¬ëŸ¬ê°€ì§€ ì¼ì„ ë™ì‹œì— ì²˜ë¦¬í•˜ëŠ” ê±¸ê¹Œ`ì— ëŒ€í•œ ì§ˆë¬¸ì„ ì°¾ì•„ê°”ë˜ ê³¼ì •ì„ ì •ë¦¬í•´ë³´ë ¤ í•œë‹¤.

### ğŸ¤” ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ì˜ ë™ì‘ íŒŒí—¤ì³ë³´ê¸°
ìë°”ìŠ¤í¬ë¦½íŠ¸ëŠ” ì‹±ê¸€ ìŠ¤ë ˆë“œ ì–¸ì–´ë‹¤. ì´ë§ì˜ ì˜ë¯¸ëŠ” í•œë²ˆì— í•˜ë‚˜ì˜ ì¼ë§Œ í•  ìˆ˜ ìˆê²Œ ì„¤ê³„ë˜ì–´ ìˆëŠ” ì–¸ì–´ë¡œ ì´ë²¤íŠ¸ ë£¨í”„ë¥¼ ì´ìš©í•´ call stackìœ¼ë¡œ ë“¤ì–´ì˜¨ í•˜ë‚˜ì˜ ì¼ë§Œ í•œë²ˆì— ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬ë©´ ì–´ë–»ê²Œ `Promise.all([...])` ê°™ì€ ì½”ë“œë¥¼ í†µí•´ **ë™ì‹œì— ì—¬ëŸ¬ê°€ì§€ ì¼ì„ ë™ì‹œì— ì²˜ë¦¬í•˜ëŠ” ê²ƒ**ì´ ê°€ëŠ¥í• ê¹Œ.

#### Sequence vs Parallel vs Concurrent
ìë°”ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì—¬ëŸ¬ê°€ì§€ ì¼ì„ ë™ì‹œì— ì²˜ë¦¬í•˜ëŠ” ê²ƒì— ëŒ€í•´ ì •í™•í•˜ê²Œ ì´í•´í•˜ê¸° ìœ„í•´ì„œëŠ” **Sequence, Parallel, Concurrent**ì˜ ì°¨ì´ë¥¼ ì´í•´í•´ì•¼ í•œë‹¤.

- **Sequence**: ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰ë˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. A -> B -> C ìˆœì„œëŒ€ë¡œ ì‹¤í–‰ë˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.
- **Parallel**: ë§ê·¸ëŒ€ë¡œ ë™ì‹œì— ì‹¤í–‰ë˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. A, B, Cê°€ ë™ì‹œì— ì‹¤í–‰ë˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.
- **Concurrent**: ë³‘ë ¬ì ìœ¼ë¡œ ì‹¤í–‰ë˜ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì´ì§€ë§Œ, ì‹¤ì œë¡œëŠ” ë™ì‹œì— ì‹¤í–‰ë˜ì§€ ì•ŠëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. A, B, Cê°€ ë™ì‹œì— ì‹¤í–‰ë˜ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì´ì§€ë§Œ, ì‹¤ì œë¡œëŠ” Aê°€ ì‹¤í–‰ë˜ê³ , Bê°€ ì‹¤í–‰ë˜ê³ , Cê°€ ì‹¤í–‰ë˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.

![ì¶œì²˜: [Does Promise.all Execute in Parallel? How Promise.all Works in JavaScript](https://javascript.plainenglish.io/does-promise-all-execute-in-parallel-how-promise-all-works-in-javascript-fffc2e8d455d)](sequential-concurrent-parallel.png)

ë”°ë¼ì„œ ìœ„ ì •ì˜ì— ë”°ë¼ ìë°”ìŠ¤í¬ë¦½íŠ¸ê°€ ì—¬ëŸ¬ê°€ì§€ ì¼ì„ ë™ì‹œì— ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì˜ ì˜ë¯¸ê°€ parallelì´ë¼ë©´ ì‹¤ì œë¡œ ì—¬ëŸ¬ê°€ì§€ ì¼ì„ ë™ì‹œì— ì‹¤í–‰í•˜ëŠ” ê²ƒìœ¼ë¡œ, concurrentí•˜ë‹¤ë©´ ìˆœì°¨ì ìœ¼ë¡œ ì§„í–‰í•˜ì§€ë§Œ ë¹ ë¥´ê²Œ ì§„í–‰ë˜ê¸°ì— ë™ì‹œì— ì§„í–‰ë˜ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì¸ë‹¤ê³  í•  ìˆ˜ ìˆë‹¤. parallelê³¼ concurrent ë‘ê°€ì§€ ë™ì‘ ì¤‘ ì–´ë–¤ ê²Œ ë§ëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ ì˜ˆë¥¼ ë“¤ì–´, ì½”ë“œì™€ í•¨ê»˜ ì•Œì•„ë³´ì.

ìë°”ìŠ¤í¬ë¦½íŠ¸ ìŠ¤ë ˆë“œë¥¼ ì›¨ì´í„°ë¡œ ì˜ˆë¥¼ ë“ ë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì •ë¦¬í•  ìˆ˜ ìˆë‹¤.
- **Sequence**: ì›¨ì´í„°ê°€ í•˜ë‚˜ì˜ í…Œì´ë¸”ì— ëŒ€í•´ ì£¼ë¬¸ì„ ë°›ê³  ìŒì‹ì´ ë‚˜ì˜¤ë©´, ë‹¤ìŒ í…Œì´ë¸”ì— ëŒ€í•´ ì£¼ë¬¸ì„ ë°›ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.
- **Parallel**: **ì—¬ëŸ¬ ì›¨ì´í„°**ê°€ ì—¬ëŸ¬ í…Œì´ë¸”ì— ëŒ€í•´ ë™ì‹œì— ì£¼ë¬¸ì„ ë°›ê³  ë™ì‹œì— ìŒì‹ì´ ë‚˜ì˜¤ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.
- **Concurrent**: í•œëª…ì˜ ì›¨ì´í„°ê°€ ì—¬ëŸ¬ í…Œì´ë¸”ì˜ ì£¼ë¬¸ì„ **ìˆœì„œëŒ€ë¡œ** ë°›ê³  ì£¼ë¬¸ì„ ë„£ì§€ë§Œ ë¹ ë¥´ê²Œ ì´ ê³¼ì •ì´ ì§„í–‰ë˜ë‹¤ ë³´ë‹ˆ ì—¬ëŸ¬ í…Œì´ë¸”ì˜ ëŒ€í•œ ìŒì‹ì´ `ê±°ì˜ ë™ì‹œ`ì— ë‚˜ì˜¤ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.

ê·¸ëŸ¬ë©´ ì˜ˆì œ ì½”ë“œë¥¼ ì´ìš©í•´ ìœ„ ì„¸ê°€ì§€ ìƒí™©ì— ëŒ€í•´ í™•ì¸í•´ë³´ì. ì•„ë˜ ì½”ë“œëŠ” `orderAndServe`ë¼ëŠ” í•¨ìˆ˜ë¥¼ ì´ìš©í•´ í…Œì´ë¸”ì— ëŒ€í•œ ì£¼ë¬¸ì„ ë°›ê³  ìŒì‹ì„ ì„œë¹™í•˜ëŠ” ì½”ë“œì´ë‹¤.

```javascript
function orderAndServe(startTime,ms, tableNumber) {
    console.log(`í…Œì´ë¸” ${tableNumber} ë„ì°© - ${new Date()-startTime}ms`);
    return new Promise((resolve) => {
        console.log(`í…Œì´ë¸” ${tableNumber} ì£¼ë¬¸ ë°›ìŒ - ${new Date()-startTime}ms`);
        return setTimeout(() => {
            resolve(tableNumber);
        }, ms);
    }).then((number) => {
        console.log(`í…Œì´ë¸” ${number} ${ms}ms í›„ ìŒì‹ ë‚˜ì˜´ - $${new Date()-startTime}ms`);
    });
}


async function sequenceRun(startTime) {
    await orderAndServe(startTime,1000,1);
    await orderAndServe(startTime,1000,2);
}

async function concurrentOrParallelRun(startTime) {
 await Promise.all([orderAndServe(startTime,1000,1), orderAndServe(startTime,1000,2)]);
}
```
ë§Œì•½ ìë°”ìŠ¤í¬ë¦½íŠ¸ê°€ `Parallel`í•˜ê²Œ ë™ì‘í•˜ë‹¤ë©´ ë‘ê°€ì§€ ê°€ì •ì„ í•´ë³¼ ìˆ˜ ìˆë‹¤.
- ì‹¤í–‰í•  ë•Œ ë§ˆë‹¤ ëë‚˜ëŠ” í…Œì´ë¸”ì˜ ìˆœì„œê°€ ë‹¤ë¥¼ ìˆ˜ ìˆë‹¤. ë…ë¦½ì ì¸ ìŠ¤ë ˆë“œì—ì„œ ì§„í–‰ë˜ê¸° ë•Œë¬¸ì— ê²°ê³¼ì˜ ìˆœì„œê°€ ë³´ì¥ë˜ì§€ ì•Šì„ ìˆ˜ ìˆë‹¤.
- ê° í…Œì´ë¸”ì— ë„ì°©í•˜ëŠ” ì‹œê°„, ì£¼ë¬¸ì„ ë°›ëŠ” ì‹œê°„, ìŒì‹ì´ ë‚˜ì˜¤ëŠ” ì‹œê°„ì´ ê°™ë‹¤.


<table width="100%" >
    <tr>
        <th>Sequential</th>
        <th>Concurrent</th>
     </tr>
  <tr>
    <td><img src="sequential.png"></td>
    <td><img src="concurrent.png"></td>
   </tr>
  </tr>
</table>

ìœ„ ì‚¬ì§„ì€ ë‘ê°€ì§€ í…Œì´ë¸”ì— ëŒ€í•´ì„œ ê° í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œ ê²°ê³¼ë¡œ, `sequential`ì²˜ëŸ¼ í•­ìƒ í…Œì´ë¸”1ì—ì„œ í…Œì´ë¸” 2ë¡œ ê°™ì€ ìˆœì„œë¡œ ì§„í–‰ë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

ìœ„ ê°€ì •í–ˆë˜ ë‘ê°€ì§€ ì¤‘ parallel í•˜ë‹¤ëŠ” ê°€ì •ì˜ ì²«ë²ˆì§¸ê°€ ì–´ê¸‹ë‚œ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ ë‘ ë²ˆì§¸ ê°€ì •ì´ì—ˆë˜ í…Œì´ë¸”ë³„ ë„ì°©, ì£¼ë¬¸, ì„œë¹™ ì‹œê°„ì´ ê°™ë‹¤ëŠ” ê°€ì •ì€ ë§ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.
ê·¸ëŸ¬ë©´ ì¡°ê¸ˆ ë” ë§ì€ í…Œì´ë¸”ì„ ì„œë¹™í•˜ê²Œ í•´ë³´ì

```javascript

function orderAndServe(startTime,ms, tableNumber) {
    console.log(`í…Œì´ë¸” ${tableNumber} ë„ì°© - ${new Date()-startTime}ms`);
    return new Promise((resolve) => {
        console.log(`í…Œì´ë¸” ${tableNumber} ì£¼ë¬¸ ë°›ìŒ - ${new Date()-startTime}ms`);
        return setTimeout(() => {
            resolve(tableNumber);
        }, ms);
    }).then((number) => {
        console.log(`í…Œì´ë¸” ${number} ${ms}ms í›„ ìŒì‹ ë‚˜ì˜´ - $${new Date()-startTime}ms`);
    });
}
const tables = Array.from({ length: 10 }, (_, i) => i + 1);

async function concurrentOrParallelRun(startTime) {
  await Promise.all(
    tables.map((tableNumber) => orderAndServe(startTime, 1000, tableNumber)),
  );
}
concurrentRun(new Date());
```

ì•„ë˜ ì‚¬ì§„ì€ ìœ„ 10ê°œì˜ í…Œì´ë¸”ì— ëŒ€í•œ ì½”ë“œë¥¼ ì‹¤í–‰í•œ ê²°ê³¼ë‹¤. ì•„ë˜ê²°ê³¼ë¥¼ ë³´ë©´ í…Œì´ë¸” 1ë¶€í„° 10ê¹Œì§€ ìˆœì„œê°€ ìœ ì§€ë˜ê³ , í…Œì´ë¸”ë³„ ê° ë™ì‘ ì™„ë£Œì‹œê°„ì˜ ì°¨ì´ê°€ ë‚˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

![í…Œì´ë¸”ì´ 10ê°œì¼ ë•Œ ê²°ê³¼](moretable.png)

ì´ë¥¼ í†µí•´ `Promise.all()`ì€ ë³‘ë ¬ì (parallelism)ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ **ë™ì‹œì„±**(concurrency)ì„ ì´ìš©í•´ ìˆœì°¨ì ìœ¼ë¡œ ì§„í–‰í•˜ì§€ë§Œ ë¹ ë¥´ê²Œ ì§„í–‰í•¨ìœ¼ë¡œì„œ ì„±ëŠ¥ì˜ ì´ì ì„ ì–»ì„ ìˆ˜ ìˆëŠ” ë©”ì†Œë“œì„ì„ ì•Œ ìˆ˜ ìˆì—ˆë‹¤.


## ë²ˆì™¸: ë³‘ë ¬ì„ ì§€ì›í•˜ë©´ ê²°ê³¼ê°€ ì–´ë–»ê²Œ ë‹¬ë¼ì§ˆê¹Œ
ë‚´ê°€ í–ˆë˜ parallelismì— ëŒ€í•œ ë‘ê°€ì§€ ê°€ì •ì´ ì‹¤ì œ ë³‘ë ¬ ì²˜ë¦¬ ì§€ì›í•˜ëŠ” ì–¸ì–´ì—ì„œ ìœ ì˜ë¯¸í•˜ê²Œ ë™ì‘í•˜ëŠ”ì§€ì— ëŒ€í•´ ì•Œì•„ë³´ê³ ì ChatGPTë¥¼ ì´ìš©í•´ `Go`ì–¸ì–´ë¡œ ìœ ì‚¬í•œ ì½”ë“œë¥¼ ì‘ì„±í•´ë³´ì•˜ë‹¤.

```
package main

import (
	"fmt"
	"sync"
	"time"
)

func orderAndServe(startTime time.Time, ms time.Duration, tableNumber int, wg *sync.WaitGroup) {
	defer wg.Done() // ì´ í•¨ìˆ˜ê°€ ëë‚˜ë©´ WaitGroupì˜ ì¹´ìš´í„°ë¥¼ ê°ì†Œì‹œí‚¨ë‹¤.

	fmt.Printf("í…Œì´ë¸” %d ë„ì°© - %vms\n", tableNumber, time.Since(startTime).Milliseconds())
	fmt.Printf("í…Œì´ë¸” %d ì£¼ë¬¸ ë°›ìŒ - %vms\n", tableNumber, time.Since(startTime).Milliseconds())
	time.Sleep(ms)
	fmt.Printf("í…Œì´ë¸” %d %vms í›„ ìŒì‹ ë‚˜ì˜´ - %vms\n", tableNumber, ms.Milliseconds(), time.Since(startTime).Milliseconds())
}

func main() {
	startTime := time.Now()
	var wg sync.WaitGroup

	// 10ê°œì˜ í…Œì´ë¸”ì— ëŒ€í•´ ë³‘ë ¬ë¡œ ì²˜ë¦¬
	for i := 1; i <= 10; i++ {
		wg.Add(1) // WaitGroupì˜ ì¹´ìš´í„°ë¥¼ ì¦ê°€ì‹œí‚¨ë‹¤.
		go orderAndServe(startTime, 1000*time.Millisecond, i, &wg)
	}

	wg.Wait() // ëª¨ë“  ê³ ë£¨í‹´ì´ ì™„ë£Œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦°ë‹¤.
}
```
ìœ„ ì½”ë“œëŠ” goì–¸ì–´ë¡œ ì‘ì„±í•œ ì½”ë“œë¡œ, `sync.WaitGroup`ì„ ì´ìš©í•´ ë³‘ë ¬ë¡œ í•¨ìˆ˜ë¥¼ ì§„í–‰ì‹œì¼°ë‹¤. ì•„ë˜ëŠ” ìœ„ ì½”ë“œë¥¼ ì‹¤í–‰í•œ ê²°ê³¼ë‹¤.

![goì–¸ì–´ë¡œ ì‘ì„±í•œ ì½”ë“œ ê²°ê³¼](goresult.png)

ê²°ê³¼ë¥¼ ë³´ë©´ í…Œì´ë¸” ë„ì°©ê³¼ ì£¼ë¬¸ë°›ìŒê¹Œì§€ ì§„í–‰ ìˆœì„œê°€ í…Œì´ë¸” 1ë¶€í„° ì§„í–‰í•˜ì§€ ì•Šê³  (ì²«ë²ˆì§¸ ê°€ì •ì˜ ë…ë¦½ì ì¸ ìŠ¤ë ˆë“œ), ì™„ë£Œí•œ ì‹œê°„ì„ ë³´ë©´ ë™ì¼í•˜ê²Œ ì²˜ë¦¬ëœ ê²ƒ (ë‘ë²ˆì§¸ ê°€ì •ì˜ ê°™ì€ ì‹œê°„ì— ì™„ë£Œ)ì„ ë³¼ ìˆ˜ ìˆì—ˆë‹¤.
ì´ë¥¼ í†µí•´ ì•ì„  ë‘ê°€ì§€ ê°€ì •ì´ ë³‘ë ¬ì²˜ë¦¬ê°€ ê°€ëŠ¥í•œ ì–¸ì–´ì˜ íŠ¹ì§•ì„ ì˜ë³´ì—¬ì£¼ëŠ” ê°€ì •ì´ì—ˆê³ , Promise.all()ì€ ë³‘ë ¬ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ **ë™ì‹œì„±**ì„ ì´ìš©í•˜ëŠ” ë©”ì†Œë“œì„ì„ í•œë²ˆ ë” í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.

[ì°¸ì¡°]
- [Does Promise.all Execute in Parallel? How Promise.all Works in JavaScript](https://javascript.plainenglish.io/does-promise-all-execute-in-parallel-how-promise-all-works-in-javascript-fffc2e8d455d)
- [Speed up your code with Promise.all](https://dev.to/dperrymorrow/speed-up-your-code-with-promiseall-3d4i)
