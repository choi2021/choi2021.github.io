{"componentChunkName":"component---src-templates-post-jsx","path":"/2024-06-30-NativeStack적용하기/","result":{"data":{"site":{"siteMetadata":{"title":"Troy DevLog"}},"markdownRemark":{"id":"f326c8c4-4a20-548d-86bf-35bd5ed917e0","excerpt":"2분기 TechOKR 작업으로 선정된 화면전환간 성능 개선 작업을 담당하면서 Native Stack Navigator을 제품에 도입하게 되었다. 해당 작업을 진행하게된 배경, 적용과정에 대해 정리하면서 새롭게 알게된 내용, 시행착오를 기록해보려 한다.  🚀 Native Stack Navigator 작업 배경 Native Stack이란 Native Stac…","html":"<p>2분기 TechOKR 작업으로 선정된 <strong>화면전환간 성능 개선</strong> 작업을 담당하면서 <strong>Native Stack Navigator</strong>을 제품에 도입하게 되었다. 해당 작업을 진행하게된 배경, 적용과정에 대해 정리하면서 새롭게 알게된 내용, 시행착오를 기록해보려 한다. </p>\n<h2>🚀 Native Stack Navigator 작업 배경</h2>\n<h3>Native Stack이란</h3>\n<p>Native Stack Navigator는 <a href=\"https://github.com/react-navigation/react-navigation\">react navigation</a>에서 지원하는 Navigator 형태 중 하나로, stack navigator의 인터페이스와 유사하게 제공하면서, stack navigator와 다르게 iOS는 <strong>UINavigationController</strong>, Android는 <strong>Fragment</strong>로 Native 요소를 이용해 화면을 구현하게 된다.</p>\n<p>Native 요소를 이용해 화면을 구현하면서 Native가 가지고 있는 성능과 특징들을 이용할 수 있는 장점을 가지지만, stackNavigator와 다르게 커스텀이 어려운 단점을 가진다.</p>\n<h3>왜 Native Stack을 도입하게 되었나</h3>\n<p>Native Stack은 이전 1분기에 <a href=\"https://choi2021.github.io/2024-03-30-App-StartUp-time-%EA%B0%9C%EC%84%A0/\">startup-time 개선 작업</a>을 진행하면서 고려했던 방법중에 있었던 작업으로,\n당시에는 화면전환간 속도가 앱 시작 시간을 최적화하는데 큰 영향이 없을 것 같아 보류해 두었다.</p>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/828f4809f25e7e8a878e4778e8cfe350/98650/ideas.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 58.235294117647065%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABU0lEQVR42q2T3U6DQBCF+/5P4mN4b2pi4oVCaflZaEspUESW/T3uAl1bNRYTNxAuZvabM3OGhZQSWmv8dmxcazXlaUil8Rj3CA58in/mLoKVj6I4oG1b9D29BmHMFEKAcw5uvlpJMKFwt2xw778PcXUJJEmCKAqRJDHquroCqi/qb3UyACntsN/vcDwW6LpuvGQeJhg2uxCUUQdTSk3tawgjS/5QYGFbteqyLAVjzAF7A/QyHx3rRrUGdgk8v9+AZVmCkGQA2lk5IO/xknqgnP4NaNtMU4I8zy8uwJjAEEZrROHGFZoNJIQMc7QrdJ6XdTWONlgHPqTgo+d6BpBSipSMTpfl0QHtPIN1AM/3wAzc7t4shU3TIIljbLcZ4jhCXdVDoG57LJ9XeHh6xa7ukb9JdFxNSm+0XBQFqqqCNeh0OrllzvO9KbTF+W+apdA5+0/nA8EwqkZTmicNAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='당시 기획해두었던 아이디어들' title='' src='/static/828f4809f25e7e8a878e4778e8cfe350/ca1dc/ideas.png' srcset='/static/828f4809f25e7e8a878e4778e8cfe350/e7570/ideas.png 170w,\n/static/828f4809f25e7e8a878e4778e8cfe350/f46e7/ideas.png 340w,\n/static/828f4809f25e7e8a878e4778e8cfe350/ca1dc/ideas.png 680w,\n/static/828f4809f25e7e8a878e4778e8cfe350/98650/ideas.png 835w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>당시 기획해두었던 아이디어들</figcaption>\n  </figure></p>\n<p>이후에 일감으로 발전시켰던 이유로 기존 제품에 stackNavigator를 이용하면서 큰 이슈는 없었지만, React Native 공식문서의 Navigation 예제가 NativeStack을 이용하는 방식으로 소개되는 것으로 수정되었고 (커뮤니티에서 성능을 위해 권장하는 방법),\n화면전환 애니메이션을 Native 스레드에서 진행하게 되면 JS 스레드가 바쁘게 진행될 때에도 안정적으로 화면 전환 애니메이션을 보장할 수 있을 것을 기대하며 작업을 시작하게 되었다.</p>\n<p>[<a href=\"https://reactnative.dev/docs/0.73/navigation\">react native 공식문서의 Navigating between screens</a>]\n<figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 82.3529411764706%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAACsElEQVR42o1US08TURjtn3Fh4gKDkYdIC7SWhyIxMTHBBA0gmPjYG+MCRRCJxsQYN66MCT4KoeUVJZgYNYEWpA90YR+46CO00xZmptN2Wo73uzNDwbjgJmfO+b659+Te+30zJkEQ4PV6EQ5H4PP5EQhscKYY2MVhB82U8wWYCoUCkqkU0uk0QwbxeALJZJLH9E7J55HL5ZBnrCgKR17P0XvSxWKRm5bK5YphimFrawsCM0qlBMQTCSQYJFGCyCDLMiSJQdawsyOyXI7lJG5qDBMFtDAajUIQ0tyYzGjioY+7u8uxZ0j3aByTNO3UMDQmHnaYaFfLKx6seNaw7PYw7caKe5Xrr9++w+1Zhc8fgNcX4Gzoda+fg/Taj3VEYzHNcOnzF1TXtaDe0gFzSzssDE22s7BYO9DEQHFjU9sem5vbUddgRXWNGSdqzag51YwjR4/j0fhTzVBkRwsGwwiFIgixVgkGQ3v8m2Fz8w/CkU1EGLR5Ya6JqbWIY7E4q7qiGaqqyiq2o1dR4jA05UVJ5LGck1m1RZ4nNipbZq1y4A7p0vOsIamvFOo31mekqVWIDZCp0Y9kShv5b1HoMfHOgUvdV9E3eBs9vTfQd41wE30DGvoHDur+wVu40nsdl3v6OV+42I3XbyYqhp8Wl3D33hCGR8cxNDyGByOPNTwkjGkY0fSwzvd10Jo7bO3Cx0X9yOxB21fVos4q/5T2x4VigecIpVKJf3L/3t2BI794+QpVJy1otnfBau+EtbUTLfZzOnfC1ko4z3GmrYu3UH2jDfWnbWiw2HGsqhZPnj2vGG5s/MJ7hxOu2QXMMLhm5jE7R3oeTtccjylPetI1jw9TLjgmpzE55cS0cxYTbx3wB35WDOkPQi2yvb2NbDbLdSaT4RWtXIHGSlHloGMb+f1X8BciPEUgtTNRrwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='react native 공식문서의 Navigating between screens' title='' src='/static/e34dd0801f56321fea70a125cd11fa1b/ca1dc/react-native-navigating.png' srcset='/static/e34dd0801f56321fea70a125cd11fa1b/e7570/react-native-navigating.png 170w,\n/static/e34dd0801f56321fea70a125cd11fa1b/f46e7/react-native-navigating.png 340w,\n/static/e34dd0801f56321fea70a125cd11fa1b/ca1dc/react-native-navigating.png 680w,\n/static/e34dd0801f56321fea70a125cd11fa1b/02d09/react-native-navigating.png 1020w,\n/static/e34dd0801f56321fea70a125cd11fa1b/9d567/react-native-navigating.png 1360w,\n/static/e34dd0801f56321fea70a125cd11fa1b/794cd/react-native-navigating.png 1802w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>react native 공식문서의 Navigating between screens</figcaption>\n  </figure></p>\n<p>[<a href=\"https://twitter.com/janicduplessis/status/1039979591815897088?s=21\">React Navigation v2의 소개된 메로리 사용량 비교 데이터</a>]\n<figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 81.17647058823529%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC2UlEQVR42pVTS08TURSeDa6MkqDCThJWpgTRxJgobsSNhhptAgWDQRQfiQvX7GTBRln4D4wI3VskJhiRqNXSlg6dPmkRaS1CH9OZPmb6mA6f995axQRCOMmXe+ece7459zv3cDkphZwsIZfPQ9d1UNve3j4Q6jk6AeecnwXvsGHl+zrEjARRkqEUizioVUkxFFw0FkcylUZBUbCVSBLSDCSJVJzLIZvNIk8ql8kqyzIKhQLx/fNT0HP1m1HjwuEwBEFAMBjCskeA1+dnELy+v/AIXiy5efj8xC/4wPMeLPE8/IEA+GUPYrGfEEWxRriWKSOSUrG2HkU0GoOqqiiXyyiVSmylqFQqKJNv6iuytRZXyFlVLbLKaQ+ojlwyLUEtllDRNJRJYrVahabVoOs1wdWShmg8yUioh15xJ3Y2hgutRFgVu1n9oEKqsDt4olf+v1dAf07V+7iwAJPJBD+RhIus/iCbAJxuF1zLPBbtdnz+YoPD6WS60M5lifBUX3rFnT+ihNQmJyfBcRzm5t6D+7WVxM0eI5raT+HyYC9aTxxlwStGI+LRON6tBvHK8QlfbXZCnN+V0GKxsByrdQacLxjGDULY3Hka5icjuGBoZcHbjx4Cmo5pP49nC7Ow2xbZG92NcGpqiuXMzBDCjc0EIezBsY52mB4Po6O1mQV77wyhWqrAEuDxwjaHcCC055XrhFZKmBIlmIzXcZwQXr07gJNNR1jw1oP70Eh3rSEvXpJJ4l08a86+hImUyDRsOduJayODaDl8iAUvdndD8AWYbslUCk6Xm725fQmThNDc18ccZ86fw73hIbanGB0dZQ9aTKcRCIWhKOoeTZn+o+HbGmF//wBzGAwGjI09/Us4Pj7OEvL5AiKra4RQ2aPC1+z8G6sVXFrMwGzuZ47Gxka0tbWhoaGBfU9MPEdiU0YsugE3mV86YnUiOiEamS76sOfnP6Cr6xK+2e34DW66KQulixx0AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='React Navigation v2의 소개된 메로리 사용량 비교 데이터' title='' src='/static/93b3191875c2a3ed6cc35f2733822895/ca1dc/x-memory-comparison.png' srcset='/static/93b3191875c2a3ed6cc35f2733822895/e7570/x-memory-comparison.png 170w,\n/static/93b3191875c2a3ed6cc35f2733822895/f46e7/x-memory-comparison.png 340w,\n/static/93b3191875c2a3ed6cc35f2733822895/ca1dc/x-memory-comparison.png 680w,\n/static/93b3191875c2a3ed6cc35f2733822895/02d09/x-memory-comparison.png 1020w,\n/static/93b3191875c2a3ed6cc35f2733822895/dc992/x-memory-comparison.png 1178w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>React Navigation v2의 소개된 메로리 사용량 비교 데이터</figcaption>\n  </figure></p>\n<p>추가로 현재 React Native는 Expo를 공식적인 프레임워크로 추천하고 있는 흐름 속에 expo에서 사용하는 routing 시스템인 Expo router도 동일하게 React Native Screens를 이용해 file-based routing 방식으로 지원하고 있다.</p>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/49232a94382c1a186b76c63956910fd4/7b4c8/expo-router.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 54.70588235294118%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABn0lEQVR42o1S27KbMAzM/39e22nTk7QJYEy4GAOB0HDbasUJoW/1jGZtWV5ZKx3SLMOXr99w/DjhdP6F488PfP9xVGy7DlzTNGGe509csF/jOKLve0xyz3V4PB4oCoeqqtW8r+DKEqX3aJo77m27Wdt2YDyJ9zYMgyZUwrppkNxuuKUZbEJMBRNF+rlPdn4TxwjCEJExsreb7/l8roTMHFsLY9bAWIIYHMk5FOOD9WxgJUFdN+AnFMWqutYzf6mEvqqUkBkW0YcaLcu8s9XHkublX/32a/m8O3Qi/Ol8Vh3v91ayVsiqHpEbYMsnnBddK6+6UuMk9YhvDknmkRY1Ct9KQ96JDsMwand/Xy6IIqNlB8YijG8wNhUprGrEKqhpbMVvqFuCwpWSbC2Z3VZCbkh2DQKEQkgkgXNOOu5Rys+cPHxhIX7uiZSLUpFjK5mHaxBqSbUIzHFhYF4U8nAtleQk26x8EzO2k1HaxoaEl2ugpbKjHHSS0bIsVyRBnss5z5WI+IpZif27ZH6VrWemSqzv/+iwjuOkQf9jr9+R8C/bVkc9ftapEAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='expo-router 인트로 섹션' title='' src='/static/49232a94382c1a186b76c63956910fd4/ca1dc/expo-router.png' srcset='/static/49232a94382c1a186b76c63956910fd4/e7570/expo-router.png 170w,\n/static/49232a94382c1a186b76c63956910fd4/f46e7/expo-router.png 340w,\n/static/49232a94382c1a186b76c63956910fd4/ca1dc/expo-router.png 680w,\n/static/49232a94382c1a186b76c63956910fd4/02d09/expo-router.png 1020w,\n/static/49232a94382c1a186b76c63956910fd4/9d567/expo-router.png 1360w,\n/static/49232a94382c1a186b76c63956910fd4/7b4c8/expo-router.png 2438w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>expo-router 인트로 섹션</figcaption>\n  </figure></p>\n<h2>🛠 Native Stack Navigator 제품에 적용해보기</h2>\n<p>기존 제품은 Stack Navigator를 사용하고 있었기 때문에 Native Stack Navigator로 마이그레이션하기 위해서는 Stack Navigator의 Navigation Option을 Native Stack Navigator에 맞게 변경하는 작업이 가장 중요하게 진행되었다.</p>\n<p>이러한 옵션중 가장 중요했던 부분은 <strong>presentation</strong> 옵션으로, presentation을 어떻게 정하느냐에 따라 화면전환 애니메이션, 화면 렌더링 스타일이 달라지게 된다. </p>\n<h3>Stack Navigator의 presentation 옵션</h3>\n<p>stack navigator에서는 <code class=\"language-text\">card</code>, <code class=\"language-text\">modal</code>, <code class=\"language-text\">transparent modal</code> 3가지 옵션을 사용할 수 있다.</p>\n<ul>\n<li><code class=\"language-text\">card</code>: 기본 화면전환 방식으로, iOS와 Android에서 default OS animation으로 화면전환이 진행된다.</li>\n<li><code class=\"language-text\">modal</code>: 화면이 모달로 뜨는 방식으로, iOS와 android 모두 화면이 아래에서 위로 올라오는 방식으로 화면이 뜨게 된다.</li>\n<li><code class=\"language-text\">transparent modal</code>: 모달로 뜨는 화면이지만, 배경이 투명하게 되어있어 이전 화면이 보이게 된다. </li>\n</ul>\n<p>[iOS Presentation별 화면전환 애니메이션]</p>\n<table>\n  <tbody><tr>\n    <td align='center'>Card</td>\n    <td align='center'>Modal</td>\n    <td align='center'>Transparent Modal</td>\n  </tr>\n  <tr>\n    <td><img src='/static/js-card-ios-416b0199f65d1b426b21ce3d0c37647d.gif' alt='js-card-ios' width='400'></td>\n    <td><img src='/static/js-modal-ios-a1d40a1c6dcea3d73da6012a2fca6517.gif' alt='js-modal-ios' width='400'></td>\n    <td><img src='/static/js-transparent-ios-9e55ee05d8634598040d4e45ed987c9a.gif' alt='js-transparent-ios.gif' width='400'></td>\n  </tr>\n</tbody></table>\n<br>\n<p>[Android Presentation별 화면전환 애니메이션]</p>\n<table>\n  <tbody><tr>\n    <td align='center'>Card</td>\n    <td align='center'>Modal</td>\n    <td align='center'>Transparent Modal</td>\n  </tr>\n  <tr>\n    <td><img src='/static/js-card-android-c5fd32aea0051cfd127dfa85b811be94.gif' alt='modal' width='300'></td>\n    <td><img src='/static/js-modal-android-657dd22a5e14c3ee91cb522a2f35ee8d.gif' alt='js-modal-android.gif' width='300'></td>\n    <td><img src='/static/js-transparent-android-5b417bb1865cba6fe463541248bfd6c9.gif' alt='js-transparent-android.gif' width='300'></td>\n  </tr>\n</tbody></table>\n<p>또한, stack Navigator의 경우 일반 View로 구현되는 화면이기 때문에 Card &#x3C;-> Modal 화면간 이동이 자유로워 Card 위에 Modal화면이 쌓이고,\nModal화면에 Card 화면이 다시 쌓일 수 있다.</p>\n<p>[Card -> Modal -> Card2 -> TransparentModal 화면전환]</p>\n<img src='/static/js-card-modal-push-1728a8dc657a6d7ddcdce7201089897d.gif' alt='modal' width='300'>\n<h3><a href=\"https://reactnavigation.org/docs/native-stack-navigator/#presentation\">Native Stack Navigator의 presentation 옵션</a></h3>\n<p>Native Stack Navigator에서는 <code class=\"language-text\">card</code>, <code class=\"language-text\">modal</code>, <code class=\"language-text\">transparent modal</code>, <code class=\"language-text\">contained modal</code>, <code class=\"language-text\">contained transparent modal</code>, <code class=\"language-text\">full screen modal</code>, <code class=\"language-text\">form sheet</code> 7가지로 구분되어 있다.</p>\n<p>iOS에서 사용하는 모달 스타일을 조금 더 세부적으로 설정할 수 있게 지원하고 있고, android에서는 모두 modal 또는 transparentModal로 fallback되어 처리된다.</p>\n<ul>\n<li><code class=\"language-text\">card</code>: 기본 화면전환 방식으로, iOS는 오른쪽에서 왼쪽으로 화면이 전환되고, Android는 OS 버전에 따라 다르게 화면전환 애니메이션이 진행된다.</li>\n<li><code class=\"language-text\">modal</code>: iOS는 네이티브 모달처럼 화면이 입체적으로 올라오는 형태의 모달을 가지고 아래에서 위로 화면이 나타나게 되지만, Android는 card와 동일한 애니메이션으로 화면이 전환된다.\n(<a href=\"https://github.com/software-mansion/react-native-screens/issues/1650\">관련 이슈</a>)</li>\n<li><code class=\"language-text\">transparent modal</code>: 이전화면이 보이는 백그라운드로 보이는 모달형태의 화면이다.</li>\n<li><code class=\"language-text\">contained modal</code>: iOS는 <code class=\"language-text\">UIModalPresentationCurrentContext</code> 모달 스타일을 이용해 부모 크기에 따라 차지하게 되며, Android는 modal과 동일하게 처리된다.</li>\n<li><code class=\"language-text\">contained transparent modal</code>: iOS는 <code class=\"language-text\">UIModalPresentationOverCurrentContext</code> 모달 스타일을 이용해 부모 크기에 따라 차지하게 되며, Android는 transparent modal과 동일하게 처리된다.</li>\n<li><code class=\"language-text\">fullScreenModal</code>: iOS는 <code class=\"language-text\">UIModalPresentationFullScreen</code> 모달 스타일을 이용해 전체 화면을 차지하게 되고, 제스처로 제거되지 않는 특징을 가진다. Android는 modal과 동일하게 처리된다.</li>\n<li><code class=\"language-text\">formSheet</code>: iOS는 <code class=\"language-text\">UIModalPresentationFormSheet</code> 모달 스타일을 이용하고 Android는 modal과 동일하게 처리된다.</li>\n</ul>\n<p>[iOS Presentation]</p>\n<table>\n  <tbody><tr>\n    <th>card</th>\n    <th>modal</th>\n    <th>transparent modal</th>\n    <th>contained modal</th>\n  </tr>\n  <tr>\n    <td><img src='/static/native-card-ios-adac74c159c6ca4a1c20e40b7c30e02e.gif' alt='card' width='300'></td>\n    <td><img src='/static/native-modal-ios-91a671b7f955c39cef0becf94ccd2a77.gif' alt='modal' width='300'></td>\n    <td><img src='/static/native-transparentModal-ios-ca77ff2561a8fbc9a832e594c34f35f6.gif' alt='card' width='300'></td>\n    <td><img src='/static/native-containedModal-ios-36264009156a53a3adad65a008fc9b95.gif' alt='modal' width='300'></td>\n  </tr>\n<tr>\n    <th>contained transparent modal</th>\n    <th>fullScreen modal</th>\n    <th>formSheet</th>\n  </tr>\n <tr>\n    <td><img src='/static/native-containedTransparentModal-ios-fcaba5f8c7353ca3691031186044ca5a.gif' alt='card' width='300'></td>\n    <td><img src='/static/native-fullScreenModal-ios-91fd8157c65852024437697f1735082e.gif' alt='modal' width='300'></td>\n    <td><img src='/static/native-formsheet-ios-0a04b571ebeee571e9be88fc10c07ded.gif' alt='card' width='300'></td>\n  </tr>\n</tbody></table>\n<p>[android Presentation (Android 14, API Level 34)]</p>\n<table>\n  <tbody><tr>\n    <th>card</th>\n    <th>modal</th>\n    <th>transparent modal</th>\n    <th>contained modal</th>\n  </tr>\n  <tr>\n    <td><img src='/static/native-card-android-2aa2ad3619ee73f88bdd86f0d5506903.gif' alt='card' width='300'></td>\n    <td><img src='/static/native-modal-android-a5b03e85925c53b6745a5ba343851186.gif' alt='modal' width='300'></td>\n    <td><img src='/static/native-transparentModal-android-fb20b63a6cb65049ad2b223fdfcb3934.gif' alt='card' width='300'></td>\n    <td><img src='/static/native-containedModal-android-85265b5b14839a9e736fb707341a25e0.gif' alt='modal' width='300'></td>\n  </tr>\n<tr>\n    <th>contained transparent modal</th>\n    <th>fullScreen modal</th>\n    <th>formSheet</th>\n  </tr>\n <tr>\n    <td><img src='/static/native-containedTransparentModal-android-bd139a1ef5da8e4f20d1d2399f1a65b1.gif' alt='card' width='300'></td>\n    <td><img src='/static/native-fullScreenModal-android-e24b13ac6ad77dbf0a4e6096334af7f6.gif' alt='modal' width='300'></td>\n    <td><img src='/static/native-formsheet-android-1fac8f2c5c0aeab0a2b9b4a4c5c36ca7.gif' alt='card' width='300'></td>\n  </tr>\n</tbody></table>\n<p>stack Navigator와 다르게 Native 요소들을 이용해 화면을 구현하기 때문에 모달은 <strong>항상 Navigation History의 마지막에 와야하는 조건</strong>이 있다. 이 조건을 지키지 않으면 Card 화면이 Modal 화면 뒤에 쌓여 보이지 않는 현상이 발생한다.</p>\n<p>[Card -> Modal -> Card2 화면전환 ]</p>\n<img src='/static/native-card-modal-push-1e5fe557b525f18f9fd4597c79b9b4de.gif' alt='modal' width='300'>\n<p>위 예시를 보면 Modal 이후 Card2로 화면전환을 진행하게 되면, Card2가 Modal 화면 뒤에 쌓이게 되어 보이지 않는 현상이 발생한다. navigation pop을 클릭하게 되면, Card2가 먼저 제거되고, 이후 Modal 화면이 제거되는 현상을 확인할 수 있다.</p>\n<p><a href=\"https://reactnavigation.org/docs/modal\">React Navigation의 가이드</a>에 따르면 모달 화면은 항상 Navigation History의 마지막에 와야한다고 되어있는데, 이는 Native Stack Navigator의 특징으로 보여진다.</p>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/9c0f7b1b52c86990d4d950e26e514225/28f63/modal-best-practice.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 23.52941176470588%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAuElEQVR42m1PXQ+CMAzk//87FWRgosKTsm9G8AU4t5Ylhtjkcm13vbVFWVZIOJ0vEE2DFNu2EY5x7P2RoPB+xDgyQgiYpok4ZP7thazhfprJ88uysKHWCkpJMKvIBlIqSKUpH2L+HhiD1JE1XlTraOZ3U495/rBhVd9Rtx3ErUclHrg2T4i2Z/7pJc461nQwxsZPNYFNZxTWeri4trUOznk6IT2mOjFv4encvM20n580xhgyWteV8AXOOnujfVot2wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='React Navigation의 가이드' title='' src='/static/9c0f7b1b52c86990d4d950e26e514225/ca1dc/modal-best-practice.png' srcset='/static/9c0f7b1b52c86990d4d950e26e514225/e7570/modal-best-practice.png 170w,\n/static/9c0f7b1b52c86990d4d950e26e514225/f46e7/modal-best-practice.png 340w,\n/static/9c0f7b1b52c86990d4d950e26e514225/ca1dc/modal-best-practice.png 680w,\n/static/9c0f7b1b52c86990d4d950e26e514225/02d09/modal-best-practice.png 1020w,\n/static/9c0f7b1b52c86990d4d950e26e514225/9d567/modal-best-practice.png 1360w,\n/static/9c0f7b1b52c86990d4d950e26e514225/28f63/modal-best-practice.png 1954w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>React Navigation의 가이드</figcaption>\n  </figure></p>\n<h3>제품 내 Navigator presentation 반영하기</h3>\n<p>그러면 이제 Native Stack Navigator의 presentation 옵션을 제품에 적용해보자.</p>\n<h4>Card</h4>\n<p>Stack Navigator와 동일하게 iOS와 Android 모두 동일하게 <code class=\"language-text\">Card</code>에 default Animation을 적용하기로 했다.\niOS는 완전히 동일하게 동작해서 큰 고민이 없었지만 Android는 별도의 애니메이션을 주어야할 지 고민이 되었다.\n그이유는 Android에서는 OS 버전에 따라 다른 화면전환 애니메이션이 진행되게 되고 기존과 다른 유저 경험에 대한 우려가 있었기 때문이다.</p>\n<p>[Stack Navigator에 정의된 Transition Preset, Android 버전별 애니메이션 옵션]</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">/**\n * Standard Android navigation transition when opening or closing an Activity on Android &lt; 9 (Oreo).\n */</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> FadeFromBottomAndroid<span class=\"token operator\">:</span> TransitionPreset <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  gestureDirection<span class=\"token operator\">:</span> <span class=\"token string\">'vertical'</span><span class=\"token punctuation\">,</span>\n  transitionSpec<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    open<span class=\"token operator\">:</span> FadeInFromBottomAndroidSpec<span class=\"token punctuation\">,</span>\n    close<span class=\"token operator\">:</span> FadeOutToBottomAndroidSpec<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  cardStyleInterpolator<span class=\"token operator\">:</span> forFadeFromBottomAndroid<span class=\"token punctuation\">,</span>\n  headerStyleInterpolator<span class=\"token operator\">:</span> forFade<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/**\n * Standard Android navigation transition when opening or closing an Activity on Android 9 (Pie).\n */</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> RevealFromBottomAndroid<span class=\"token operator\">:</span> TransitionPreset <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  gestureDirection<span class=\"token operator\">:</span> <span class=\"token string\">'vertical'</span><span class=\"token punctuation\">,</span>\n  transitionSpec<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    open<span class=\"token operator\">:</span> RevealFromBottomAndroidSpec<span class=\"token punctuation\">,</span>\n    close<span class=\"token operator\">:</span> RevealFromBottomAndroidSpec<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  cardStyleInterpolator<span class=\"token operator\">:</span> forRevealFromBottomAndroid<span class=\"token punctuation\">,</span>\n  headerStyleInterpolator<span class=\"token operator\">:</span> forFade<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/**\n * Standard Android navigation transition when opening or closing an Activity on Android 10 (Q).\n */</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> ScaleFromCenterAndroid<span class=\"token operator\">:</span> TransitionPreset <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  gestureDirection<span class=\"token operator\">:</span> <span class=\"token string\">'horizontal'</span><span class=\"token punctuation\">,</span>\n  transitionSpec<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    open<span class=\"token operator\">:</span> ScaleFromCenterAndroidSpec<span class=\"token punctuation\">,</span>\n    close<span class=\"token operator\">:</span> ScaleFromCenterAndroidSpec<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  cardStyleInterpolator<span class=\"token operator\">:</span> forScaleFromCenterAndroid<span class=\"token punctuation\">,</span>\n  headerStyleInterpolator<span class=\"token operator\">:</span> forFade<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>아래 GIF에서 기존은 가운데에서 퍼져나가는 형식(ScaleFromCenterAndroid)으로 화면이 전환된다면, Native Stack에서는 오른쪽에서 왼쪽으로 화면이 전환되는 것을 확인할 수 있다.</p>\n<table>\n  <tbody><tr>\n    <th>기존 안드로이드 화면전환</th>\n    <th>Native Stack 화면 전환</th>\n  </tr>\n  <tr>\n    <td><img src='/static/js-card-android-c5fd32aea0051cfd127dfa85b811be94.gif' alt='card' width='300'></td>\n    <td><img src='/static/native-card-android-2aa2ad3619ee73f88bdd86f0d5506903.gif' alt='modal' width='300'></td>\n  </tr>\n</tbody></table>\n<p>기존 <code class=\"language-text\">ScaleFromCenterAndroid</code>와 최대한 유사한 애니메이션으로 <code class=\"language-text\">Fade</code> 애니메이션을 처음 고민해봤지만, 여전히 기존과 다른게 느껴지는 것 같다는 동료분의 피드백을 받았고,\n버전에 맞게 표준 애니메이션을 적용하는 default 옵션이 이후 유지보수 측면에서 좋을 것 같다는 좋은 조언을 해주셔서, <code class=\"language-text\">Card</code> 옵션을 그대로 적용하기로 했다.</p>\n<h4>Modal</h4>\n<p>작업 중 가장 이슈가 많았고, OS별로 기본적으로 제공하는 부분이 달라 고민이 많았던 작업 영역이었다.</p>\n<p>OS별로 모달 옵션들을 정리해보면 iOS에서는 <code class=\"language-text\">modal, contained modal, fullscreen modal, formsheet</code> 4가지가 있고, android는 <code class=\"language-text\">modal</code> 한가지 옵션만 제공하지만 이슈가 있어서 추가적으로 애니메이션 옵션을 적용해야하는 상황이었다.</p>\n<p>여기에 추가적으로 모달이 항상 Navigation History의 마지막에 와야하는 조건이 있어서, 이를 지키지 않으면 기존 제품과 다르게 화면이 보이지 않는 이슈가 발생해, card와 modal간 화면 전환의 자유도도 고민해야 했다.</p>\n<p>결론적으로는 위에서 언급한 옵션들이 아닌 iOS와 Android 모두 <code class=\"language-text\">Card</code> 옵션에 <code class=\"language-text\">slide_from_bottom</code> 애니메이션을 적용한 형태로 적용하기로 했다.</p>\n<p>왜 뜬금없이 <code class=\"language-text\">Card</code>냐는 의문이 들 수 있겠지만, android에 이슈로 인해 추가적인 애니메이션이 필수적으로 필요한 상황인 점과 기존 제품 내 Navigation History 관리 방식을 유지해 작업범위와 컨벤션을 지키는 것이 더 좋겠다는 점을 고려해 선택하게 되었다.</p>\n<p>그러면 각 옵션들을 적용했을 때 발생했던 이슈들을 정리해보자.</p>\n<h5>Modal와 FormSheet</h5>\n<p>iOS에서는 <code class=\"language-text\">modal</code>와 <code class=\"language-text\">formsheet</code> 옵션을 적용했을 때, 기존 제품내 모달과 다르게 화면 전체를 차지하는게 아니라 일정 영역만 차지하고 위로 떠있는 형태를 가지게 되고, android는 card와 동일하게 화면 전환이 이루어지는 이슈가 있어 사용하지 못했다.</p>\n<p>[제품내 모달과 Modal 옵션]</p>\n<table>\n  <tbody><tr>\n    <th>기존 제품내 모달 화면</th>\n    <th>modal iOS</th>\n    <th>modal android</th>\n  </tr>\n  <tr>\n    <td><img src='/static/stack-modal-ios-226c4371aa3925ab84ab76746b0e740c.gif' alt='card' width='300'></td>\n    <td><img src='/static/product-modal-ios-eba28d51b423052dbee5870a8a123c92.gif' alt='card' width='300'></td>\n    <td><img src='/static/product-modal-android-7bfe501a3c18f7ba0ea59226a63f6973.gif' alt='modal' width='300'></td>\n  </tr>\n</tbody></table>\n<p>[제품내 모달과 formsheet 옵션]</p>\n<table>\n  <tbody><tr>\n    <th>기존 제품내 모달 화면</th>\n    <th>formsheet iOS</th>\n    <th>formsheet android</th>\n  </tr>\n  <tr>\n    <td><img src='/static/stack-modal-ios-226c4371aa3925ab84ab76746b0e740c.gif' alt='card' width='300'></td>\n    <td><img src='/static/product-formsheet-ios-edcbff85fa0dccc19a74ef6978ec9fb8.gif' alt='modal' width='300'></td>\n    <td><img src='/static/product-formsheet-android-b4cafbb91797ac0dd8dfd742717e3e75.gif' alt='modal' width='300'></td>\n  </tr>\n</tbody></table>\n<h5>Contained Modal과 FullScreen Modal</h5>\n<p>android는 card와 동일하게 화면 전환이 이루어지는 이슈가 동일하게 있지만, iOS에서는 <code class=\"language-text\">contained modal</code>과 <code class=\"language-text\">fullscreen modal</code> 옵션을 적용했을 때, 기존과 같이 화면이 전체를 차지하는 형태로 화면이 나타낼 수 있어 사용하려 했던 옵션이었다.</p>\n<p>하지만 각 옵션은 적용에 있어 문제점들이 각각 존재했다. contained Modal의 경우에는 Navigation History의 마지막에 와야하는 조건을 위해 별도의 Nested Navigator로 모달들을 관리하는 비용이 컸다는 점으로 인해 사용하지 못했다.</p>\n<p>fullscreen Modal 옵션은 card,modal간 화면 전환 이슈와 더불어, alert 모달을 상위에 띄워줄 수 없는 이슈가 있어 사용하지 못했다. 아래는 해당 상황을 위한 mimic 코드이다.</p>\n<p>[fullscreen modal에서 Modal로 구현한 alert가 뜨지 않는 이슈를 위한 mimic 코드]</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// zustand로 구현한 전역 모달 노출 코드</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>create<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'zustand'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> useAlertModal <span class=\"token operator\">=</span> <span class=\"token function\">create</span><span class=\"token punctuation\">(</span>set <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    visible<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function-variable function\">show</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>visible<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function-variable function\">hide</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>visible<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">App</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> visible <span class=\"token operator\">=</span> <span class=\"token function\">useAlertModal</span><span class=\"token punctuation\">(</span>state <span class=\"token operator\">=></span> state<span class=\"token punctuation\">.</span>visible<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> close <span class=\"token operator\">=</span> <span class=\"token function\">useAlertModal</span><span class=\"token punctuation\">(</span>state <span class=\"token operator\">=></span> state<span class=\"token punctuation\">.</span>hide<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">onPressClose</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">SafeAreaView</span></span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>flex<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token punctuation\">{</span>visible <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Modal</span></span>\n          <span class=\"token attr-name\">visible</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>visible<span class=\"token punctuation\">}</span></span>\n          <span class=\"token attr-name\">animationType</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'fade'</span><span class=\"token punctuation\">}</span></span>\n          <span class=\"token attr-name\">transparent</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span></span>\n          <span class=\"token attr-name\">onRequestClose</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>onPressClose<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">View</span></span>\n            <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\n              justifyContent<span class=\"token operator\">:</span> <span class=\"token string\">'center'</span><span class=\"token punctuation\">,</span>\n              alignItems<span class=\"token operator\">:</span> <span class=\"token string\">'center'</span><span class=\"token punctuation\">,</span>\n              backgroundColor<span class=\"token operator\">:</span> <span class=\"token string\">'white'</span><span class=\"token punctuation\">,</span>\n              flex<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Text</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Modal이에요</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Text</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Button</span></span> <span class=\"token attr-name\">title</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>닫기<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">onPress</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>onPressClose<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">View</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Modal</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">NavigationContainer</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">NativeStack</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">NavigationContainer</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">SafeAreaView</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">FullscreenModal</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>navigation<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handlePress</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        navigation<span class=\"token punctuation\">.</span><span class=\"token function\">pop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> show <span class=\"token operator\">=</span> <span class=\"token function\">useAlertModal</span><span class=\"token punctuation\">(</span>state <span class=\"token operator\">=></span> state<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">showAlert</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">SafeAreaView</span></span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>flex<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Button</span></span> <span class=\"token attr-name\">title</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>뒤로가기<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">onPress</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>handlePress<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Button</span></span> <span class=\"token attr-name\">title</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>alert 띄우기<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">onPress</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>showAlert<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">SafeAreaView</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<table>\n  <tbody><tr>\n    <td>Modal로 구현한 alert 컴포넌트가 상위에 뜨지 않는 이슈</td>\n  </tr>\n  <tr>\n    <td><img src='/static/mimic-fullscreen-issue-a1b99684ebfa096582096c64b978d647.gif' alt='modal' width='300'></td>\n  </tr>\n</tbody></table>\n<p>이러한 이슈들로 인해 iOS와 Android 모두 <code class=\"language-text\">Card</code> 옵션에 <code class=\"language-text\">slide_from_bottom</code> 애니메이션을 적용한 형태로 적용하기로 했다.</p>\n<h5>slide<em>from</em>bottom 속도 이슈 해결하기</h5>\n<p>이제 더이상 이슈가 없을 것이라 생각했지만 <code class=\"language-text\">Card</code> 옵션에 <code class=\"language-text\">slide_from_bottom</code> 옵션을 적용하는 방식에도 이슈가 있었다. </p>\n<p>바로 모달이 뜨는 애니메이션 속도 이슈로 iOS에서는 duration을 옵션으로 정할 수 있게 제공하지만, android에서는 커스텀할 수 없어 기존과 체감이 될정도로 느리게 화면이 전환되는 이슈가 있었다.</p>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/e0ce71423aaa855b58fa88ad7d70de78/8ef96/react-navigation-animationDuration.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 22.941176470588236%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAkElEQVR42q1Q0QoDIQzz/7/zBoo3bdVTUUdmdexpD4NNCLXVNGmVtScExIx/HHUcN2itYc8TMSYQMUKIEwHMAd4TQoyr7pxfUcR5vt+d2znR/MuTH6GMMbOZRbou1FqRc0Yp5RV3nnNBaw299w8Y7/sYA2qr0HIoauKSlztGSmk5lfoYj+9GFoKMKGRR+XWHT6GdhktfSYK8AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='animationDuration 공식문서' title='' src='/static/e0ce71423aaa855b58fa88ad7d70de78/ca1dc/react-navigation-animationDuration.png' srcset='/static/e0ce71423aaa855b58fa88ad7d70de78/e7570/react-navigation-animationDuration.png 170w,\n/static/e0ce71423aaa855b58fa88ad7d70de78/f46e7/react-navigation-animationDuration.png 340w,\n/static/e0ce71423aaa855b58fa88ad7d70de78/ca1dc/react-navigation-animationDuration.png 680w,\n/static/e0ce71423aaa855b58fa88ad7d70de78/02d09/react-navigation-animationDuration.png 1020w,\n/static/e0ce71423aaa855b58fa88ad7d70de78/9d567/react-navigation-animationDuration.png 1360w,\n/static/e0ce71423aaa855b58fa88ad7d70de78/8ef96/react-navigation-animationDuration.png 1960w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>animationDuration 공식문서</figcaption>\n  </figure></p>\n<table>\n  <tbody><tr>\n    <td>Android Stack Navigator Modal</td>\n    <td>Android Native Stack Card (slide_from_bottom)</td>\n  </tr>\n  <tr>\n    <td><img src='/static/js-modal-android-657dd22a5e14c3ee91cb522a2f35ee8d.gif' alt='modal' width='300'></td>\n    <td><img src='/static/android-animation-velocity-before-11e1eb9cd9b9fd30d411015f2d4e8f5d.gif' alt='modal' width='300'></td>\n  </tr>\n</tbody></table>\n<p>눈에 띄게 느리다는 느낌이 들어 해당 부분을 해결하기 위해 React Navigation 내부 코드를 하나하나 분석하게 되었다.</p>\n<p>먼저 NativeStackNavigator를 만들기 위한 <code class=\"language-text\">createNativeStackNavigator</code>를 보면 <code class=\"language-text\">createNavigatorFactory</code> 팩토리 함수에 <code class=\"language-text\">NativeStackNavigator</code>를 인자로 넘겨주는 방식으로 NativeStackNavigator를 만들고 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">//[참조 코드](https://github.com/react-navigation/react-navigation/blob/main/packages/native-stack/src/navigators/createNativeStackNavigator.tsx)</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">NativeStackNavigator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>rest <span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> NativeStackNavigatorProps<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token operator\">...</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">NavigationContent</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">NativeStackView</span></span>\n                <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>rest<span class=\"token punctuation\">}</span></span>\n                <span class=\"token attr-name\">state</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>state<span class=\"token punctuation\">}</span></span>\n                <span class=\"token attr-name\">navigation</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>navigation<span class=\"token punctuation\">}</span></span>\n                <span class=\"token attr-name\">descriptors</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>descriptors<span class=\"token punctuation\">}</span></span>\n            <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">NavigationContent</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token generic-function\"><span class=\"token function\">createNativeStackNavigator</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>\n    ParamList <span class=\"token keyword\">extends</span> ParamListBase<span class=\"token punctuation\">,</span>\n    NavigatorID <span class=\"token keyword\">extends</span> <span class=\"token builtin\">string</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">,</span>\n    TypeBag <span class=\"token keyword\">extends</span> NavigatorTypeBagBase <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n        ParamList<span class=\"token operator\">:</span> ParamList<span class=\"token punctuation\">;</span>\n        NavigatorID<span class=\"token operator\">:</span> NavigatorID<span class=\"token punctuation\">;</span>\n        State<span class=\"token operator\">:</span> StackNavigationState<span class=\"token operator\">&lt;</span>ParamList<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n        ScreenOptions<span class=\"token operator\">:</span> NativeStackNavigationOptions<span class=\"token punctuation\">;</span>\n        EventMap<span class=\"token operator\">:</span> NativeStackNavigationEventMap<span class=\"token punctuation\">;</span>\n        NavigationList<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token punctuation\">[</span>RouteName <span class=\"token keyword\">in</span> <span class=\"token keyword\">keyof</span> ParamList<span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> NativeStackNavigationProp<span class=\"token operator\">&lt;</span>\n                ParamList<span class=\"token punctuation\">,</span>\n                RouteName<span class=\"token punctuation\">,</span>\n                NavigatorID\n            <span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n        Navigator<span class=\"token operator\">:</span> <span class=\"token keyword\">typeof</span> NativeStackNavigator<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    Config <span class=\"token keyword\">extends</span> StaticConfig<span class=\"token operator\">&lt;</span>TypeBag<span class=\"token operator\">></span> <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span> <span class=\"token operator\">=</span>\n            <span class=\"token operator\">|</span> StaticConfig<span class=\"token operator\">&lt;</span>TypeBag<span class=\"token operator\">></span>\n        <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">,</span>\n<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span>config<span class=\"token operator\">?</span><span class=\"token operator\">:</span> Config<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> TypedNavigator<span class=\"token operator\">&lt;</span>TypeBag<span class=\"token punctuation\">,</span> Config<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">createNavigatorFactory</span><span class=\"token punctuation\">(</span>NativeStackNavigator<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>config<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>내가 궁금한건 스크린이 어떻게 만들어지냐니까 이제 NativeStackView 코드 내부를 보게 되면 <code class=\"language-text\">React Native Screens</code>에서 Screen, ScreenStack 컴포넌트를 받아서 prop을 전달하는 방식으로 wrapping하고 있다는 것을 알 수 있었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">//[참조 코드](https://github.com/react-navigation/react-navigation/blob/main/packages/native-stack/src/views/NativeStackView.native.tsx):`react-navigation/packages/native-stack/src/views/NativeStackView.native.tsx`)</span>\n<span class=\"token comment\">//...</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n    Screen<span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">type</span> <span class=\"token class-name\">ScreenProps</span><span class=\"token punctuation\">,</span>\n    ScreenStack<span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">type</span> <span class=\"token class-name\">StackPresentationTypes</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-native-screens'</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//...</span>\n\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">MaybeNestedStack</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">//...</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isHeaderInModal<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ScreenStack</span></span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>container<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n                </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Screen</span></span>\n                    <span class=\"token attr-name\">enabled</span>\n                    <span class=\"token attr-name\">isNativeStack</span>\n                    <span class=\"token attr-name\">hasLargeHeader</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>options<span class=\"token punctuation\">.</span>headerLargeTitle <span class=\"token operator\">??</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">}</span></span>\n                    <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>StyleSheet<span class=\"token punctuation\">.</span>absoluteFill<span class=\"token punctuation\">}</span></span>\n                <span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n                    </span><span class=\"token punctuation\">{</span>content<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n                    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">HeaderConfig</span></span>\n                        <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>options<span class=\"token punctuation\">}</span></span>\n                        <span class=\"token attr-name\">route</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>route<span class=\"token punctuation\">}</span></span>\n                        <span class=\"token attr-name\">headerHeight</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>headerHeight<span class=\"token punctuation\">}</span></span>\n                        <span class=\"token attr-name\">headerTopInsetEnabled</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>headerTopInsetEnabled<span class=\"token punctuation\">}</span></span>\n                        <span class=\"token attr-name\">canGoBack</span>\n                    <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n                </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Screen</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">ScreenStack</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">return</span> content<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">SceneView</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">//...</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Screen</span></span>\n            <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>route<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">}</span></span>\n            <span class=\"token attr-name\">enabled</span>\n            <span class=\"token attr-name\">isNativeStack</span>\n            <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>StyleSheet<span class=\"token punctuation\">.</span>absoluteFill<span class=\"token punctuation\">}</span></span>\n            <span class=\"token attr-name\">hasLargeHeader</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>options<span class=\"token punctuation\">.</span>headerLargeTitle <span class=\"token operator\">??</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">}</span></span>\n            <span class=\"token attr-name\">customAnimationOnSwipe</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>animationMatchesGesture<span class=\"token punctuation\">}</span></span>\n            <span class=\"token attr-name\">fullScreenSwipeEnabled</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>fullScreenGestureEnabled<span class=\"token punctuation\">}</span></span>\n            <span class=\"token comment\">// ... 기타 props</span>\n        <span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Screen</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">Props</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    state<span class=\"token operator\">:</span> StackNavigationState<span class=\"token operator\">&lt;</span>ParamListBase<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n    navigation<span class=\"token operator\">:</span> NativeStackNavigationHelpers<span class=\"token punctuation\">;</span>\n    descriptors<span class=\"token operator\">:</span> NativeStackDescriptorMap<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">NativeStackView</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> state<span class=\"token punctuation\">,</span> navigation<span class=\"token punctuation\">,</span> descriptors <span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> Props<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token operator\">...</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">SafeAreaProviderCompat</span></span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> backgroundColor<span class=\"token operator\">:</span> colors<span class=\"token punctuation\">.</span>background <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ScreenStack</span></span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>container<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n                </span><span class=\"token punctuation\">{</span>state<span class=\"token punctuation\">.</span>routes<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>route<span class=\"token punctuation\">,</span> index<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token comment\">//...</span>\n                    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n                        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">SceneView</span></span>\n                            <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>route<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">}</span></span>\n                            <span class=\"token attr-name\">index</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>index<span class=\"token punctuation\">}</span></span>\n                            <span class=\"token attr-name\">focused</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>isFocused<span class=\"token punctuation\">}</span></span>\n                            <span class=\"token attr-name\">descriptor</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>descriptor<span class=\"token punctuation\">}</span></span>\n                            <span class=\"token attr-name\">previousDescriptor</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>previousDescriptor<span class=\"token punctuation\">}</span></span>\n                            <span class=\"token attr-name\">nextDescriptor</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>nextDescriptor<span class=\"token punctuation\">}</span></span>\n                            <span class=\"token attr-name\">isPresentationModal</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>isModal<span class=\"token punctuation\">}</span></span>\n                            <span class=\"token comment\">// 기타 props</span>\n                        <span class=\"token punctuation\">/></span></span>\n                    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">ScreenStack</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">SafeAreaProviderCompat</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>실제 애니메이션 속도를 변경하기 위해서는 React Navigation 코드가 아니라 <strong>React Native Screens</strong> 패키지 내부 코드를 수정해야하는 것을 알게 되었다.\n그래서 React Navigation에서 Native Stack의 이슈는 React Native Screens 레포에 올려달라했구나 이해가 되었다.</p>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/533b439c5f689b068a73d15b21d6b005/98f2e/react-native-screens-%EC%95%88%EB%82%B4.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 55.294117647058826%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABdklEQVR42qWSC2+DMAyE+///4LR2bG3Z1vJoSCAvoHA7h7aa1FWbNKRTHOA+24lXzjlkWYbn9RrrzQZ5/o7/PKtxHFHXFfYECexwOKLrLKx1cN6nuLOLnPOwTt47eB/g7QBHpZXfzuczVtM002xhTAutDVSjoZRCozV8CAl6lSQXk2iaJu7PFNdheTfPM1YSmLaj2gQx3SU2hnsD3RgYqmPCSUwsQIwz27tTAjKT0pEgh5NUd2pwqlWCaO3hTUA0HqFhm5rtKmk9wsfhTqEfF+Dn0aIsGzhCrDJwuqWRcUszf7wqGfvhR9gNKGUWtcV7XqIsSmheRuCZ2P4CCT0i9yIxPILdgHIpoe/xtt8j2+2Qvb5BPeVQ2Se22RbPLxl2vP3qpHg0LayPvwBZYedCMm33OfKPA9qC7VctjkWFoqrT2vBSHGGOFT8CxusZCvB7lsBx8MN4a/VRuy5Qvk9JrF8SXVpeQJJhif8mARkTOQ2R0yFD3+MLy7VTbmK7qb8AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='React Native Screens로 안내하는 React Navigation 공식문서' title='' src='/static/533b439c5f689b068a73d15b21d6b005/ca1dc/react-native-screens-%EC%95%88%EB%82%B4.png' srcset='/static/533b439c5f689b068a73d15b21d6b005/e7570/react-native-screens-%EC%95%88%EB%82%B4.png 170w,\n/static/533b439c5f689b068a73d15b21d6b005/f46e7/react-native-screens-%EC%95%88%EB%82%B4.png 340w,\n/static/533b439c5f689b068a73d15b21d6b005/ca1dc/react-native-screens-%EC%95%88%EB%82%B4.png 680w,\n/static/533b439c5f689b068a73d15b21d6b005/02d09/react-native-screens-%EC%95%88%EB%82%B4.png 1020w,\n/static/533b439c5f689b068a73d15b21d6b005/9d567/react-native-screens-%EC%95%88%EB%82%B4.png 1360w,\n/static/533b439c5f689b068a73d15b21d6b005/98f2e/react-native-screens-%EC%95%88%EB%82%B4.png 2012w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>React Native Screens로 안내하는 React Navigation 공식문서</figcaption>\n  </figure></p>\n<p>이어서 React Native Screens 패키지 내부 코드를 분석하게 되었고, 아래와 같이 Screen 코드를 간단하게 나타낼 수 있고, Screen 컴포넌트는 ScreenNativeComponent를 만들어지는 것을 볼 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">//[참조 코드](react-native-screens/src/components/Screen.tsx)</span>\n<span class=\"token comment\">// ...</span>\n<span class=\"token keyword\">import</span> ScreenNativeComponent <span class=\"token keyword\">from</span> <span class=\"token string\">'../fabric/ScreenNativeComponent'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> ModalScreenNativeComponent <span class=\"token keyword\">from</span> <span class=\"token string\">'../fabric/ModalScreenNativeComponent'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> NativeScreen<span class=\"token operator\">:</span> React<span class=\"token punctuation\">.</span>ComponentType<span class=\"token operator\">&lt;</span>ScreenProps<span class=\"token operator\">></span> <span class=\"token operator\">=</span>\n    ScreenNativeComponent <span class=\"token keyword\">as</span> React<span class=\"token punctuation\">.</span>ComponentType<span class=\"token operator\">&lt;</span>ScreenProps<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> AnimatedNativeScreen <span class=\"token operator\">=</span> Animated<span class=\"token punctuation\">.</span><span class=\"token function\">createAnimatedComponent</span><span class=\"token punctuation\">(</span>NativeScreen<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// ...</span>\n\n<span class=\"token keyword\">const</span> Screen<span class=\"token operator\">:</span> React<span class=\"token punctuation\">.</span><span class=\"token constant\">FC</span><span class=\"token operator\">&lt;</span>ScreenProps<span class=\"token operator\">></span> <span class=\"token operator\">=</span> props <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">AnimatedNativeScreen</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>props<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Screen<span class=\"token punctuation\">;</span></code></pre></div>\n<p>그리고 ScreenNativeComponent 코드를 보게 되면, <code class=\"language-text\">Screen</code> 컴포넌트를 만들어주는 코드를 찾을 수 있었다.\n아래 코드는 <a href=\"https://github.com/reactwg/react-native-new-architecture/blob/main/docs/codegen.md\"><strong>codegen</strong></a>을 이용해 Screen 컴포넌트를 iOS와 Android를 빌드할 때 자동으로 생성하기 위한 인터페이스들이 정의되어 있는 코드이다.\n이제 codegen을 통해 만들어진 해당 코드 부분을 찾아가면 드디어 내가 원하는 안드로이드 애니메이션 속도를 변경할 수 있을 것이라고 생각할 수 있었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token comment\">//[참조코드](react-native-screens/src/fabric/ScreenNativeComponent.ts)</span>\n<span class=\"token keyword\">import</span> codegenNativeComponent <span class=\"token keyword\">from</span> <span class=\"token string\">'react-native/Libraries/Utilities/codegenNativeComponent'</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// ...</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">StackPresentation</span> <span class=\"token operator\">=</span>\n  <span class=\"token operator\">|</span> <span class=\"token string\">'push'</span>\n  <span class=\"token operator\">|</span> <span class=\"token string\">'modal'</span>\n  <span class=\"token operator\">|</span> <span class=\"token string\">'transparentModal'</span>\n  <span class=\"token operator\">|</span> <span class=\"token string\">'fullScreenModal'</span>\n  <span class=\"token operator\">|</span> <span class=\"token string\">'formSheet'</span>\n  <span class=\"token operator\">|</span> <span class=\"token string\">'containedModal'</span>\n  <span class=\"token operator\">|</span> <span class=\"token string\">'containedTransparentModal'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">StackAnimation</span> <span class=\"token operator\">=</span>\n  <span class=\"token operator\">|</span> <span class=\"token string\">'default'</span>\n  <span class=\"token operator\">|</span> <span class=\"token string\">'flip'</span>\n  <span class=\"token operator\">|</span> <span class=\"token string\">'simple_push'</span>\n  <span class=\"token operator\">|</span> <span class=\"token string\">'none'</span>\n  <span class=\"token operator\">|</span> <span class=\"token string\">'fade'</span>\n  <span class=\"token operator\">|</span> <span class=\"token string\">'slide_from_right'</span>\n  <span class=\"token operator\">|</span> <span class=\"token string\">'slide_from_left'</span>\n  <span class=\"token operator\">|</span> <span class=\"token string\">'slide_from_bottom'</span>\n  <span class=\"token operator\">|</span> <span class=\"token string\">'fade_from_bottom'</span>\n  <span class=\"token operator\">|</span> <span class=\"token string\">'ios'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// ...</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token generic-function\"><span class=\"token function\">codegenNativeComponent</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>NativeProps<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'RNSScreen'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  interfaceOnly<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>드디어 rnscreens 내부의 ScreenStack 코드에서 애니메이션 설정 코드를 발견할 수 있었다.\n그중 내가 찾던 <code class=\"language-text\">slide_from_bottom</code>애니메이션은  <code class=\"language-text\">R.anim.rns_slide_in_from_bottom</code>, <code class=\"language-text\">R.anim.rns_no_animation_medium</code>으로 정의되어 있었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token punctuation\">[</span>참고 코드<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>react<span class=\"token operator\">-</span>native<span class=\"token operator\">-</span>screens<span class=\"token operator\">/</span>android<span class=\"token operator\">/</span>src<span class=\"token operator\">/</span>main<span class=\"token operator\">/</span>java<span class=\"token operator\">/</span>com<span class=\"token operator\">/</span>swmansion<span class=\"token operator\">/</span>rnscreens<span class=\"token operator\">/</span>ScreenStack<span class=\"token punctuation\">.</span>kt<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">class</span> <span class=\"token function\">ScreenStack</span><span class=\"token punctuation\">(</span>context<span class=\"token operator\">:</span> Context<span class=\"token operator\">?</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token function\">ScreenContainer</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token operator\">..</span><span class=\"token punctuation\">.</span>\n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">fun</span> <span class=\"token function\">onUpdate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token operator\">..</span><span class=\"token punctuation\">.</span>\n        <span class=\"token function\">createTransaction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">let</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token comment\">// animation logic start</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>stackAnimation <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>shouldUseOpenAnimation<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token keyword\">when</span> <span class=\"token punctuation\">(</span>stackAnimation<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                        StackAnimation<span class=\"token punctuation\">.</span>DEFAULT <span class=\"token operator\">-></span> it<span class=\"token punctuation\">.</span><span class=\"token function\">setCustomAnimations</span><span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_default_enter_in<span class=\"token punctuation\">,</span> R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_default_enter_out<span class=\"token punctuation\">)</span>\n                        StackAnimation<span class=\"token punctuation\">.</span>NONE <span class=\"token operator\">-></span> it<span class=\"token punctuation\">.</span><span class=\"token function\">setCustomAnimations</span><span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_no_animation_20<span class=\"token punctuation\">,</span> R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_no_animation_20<span class=\"token punctuation\">)</span>\n                        StackAnimation<span class=\"token punctuation\">.</span>FADE <span class=\"token operator\">-></span> it<span class=\"token punctuation\">.</span><span class=\"token function\">setCustomAnimations</span><span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_fade_in<span class=\"token punctuation\">,</span> R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_fade_out<span class=\"token punctuation\">)</span>\n                        StackAnimation<span class=\"token punctuation\">.</span>SLIDE_FROM_RIGHT <span class=\"token operator\">-></span> it<span class=\"token punctuation\">.</span><span class=\"token function\">setCustomAnimations</span><span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_slide_in_from_right<span class=\"token punctuation\">,</span> R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_slide_out_to_left<span class=\"token punctuation\">)</span>\n                        StackAnimation<span class=\"token punctuation\">.</span>SLIDE_FROM_LEFT <span class=\"token operator\">-></span> it<span class=\"token punctuation\">.</span><span class=\"token function\">setCustomAnimations</span><span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_slide_in_from_left<span class=\"token punctuation\">,</span> R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_slide_out_to_right<span class=\"token punctuation\">)</span>\n                        StackAnimation<span class=\"token punctuation\">.</span>SLIDE_FROM_BOTTOM <span class=\"token operator\">-></span> it<span class=\"token punctuation\">.</span><span class=\"token function\">setCustomAnimations</span><span class=\"token punctuation\">(</span>\n                            R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_slide_in_from_bottom<span class=\"token punctuation\">,</span> R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_no_animation_medium\n                        <span class=\"token punctuation\">)</span>\n                        StackAnimation<span class=\"token punctuation\">.</span>FADE_FROM_BOTTOM <span class=\"token operator\">-></span> it<span class=\"token punctuation\">.</span><span class=\"token function\">setCustomAnimations</span><span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_fade_from_bottom<span class=\"token punctuation\">,</span> R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_no_animation_350<span class=\"token punctuation\">)</span>\n                        StackAnimation<span class=\"token punctuation\">.</span>IOS <span class=\"token operator\">-></span> it<span class=\"token punctuation\">.</span><span class=\"token function\">setCustomAnimations</span><span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_slide_in_from_right_ios<span class=\"token punctuation\">,</span> R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_slide_out_to_left_ios<span class=\"token punctuation\">)</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token keyword\">when</span> <span class=\"token punctuation\">(</span>stackAnimation<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                        StackAnimation<span class=\"token punctuation\">.</span>DEFAULT <span class=\"token operator\">-></span> it<span class=\"token punctuation\">.</span><span class=\"token function\">setCustomAnimations</span><span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_default_exit_in<span class=\"token punctuation\">,</span> R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_default_exit_out<span class=\"token punctuation\">)</span>\n                        StackAnimation<span class=\"token punctuation\">.</span>NONE <span class=\"token operator\">-></span> it<span class=\"token punctuation\">.</span><span class=\"token function\">setCustomAnimations</span><span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_no_animation_20<span class=\"token punctuation\">,</span> R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_no_animation_20<span class=\"token punctuation\">)</span>\n                        StackAnimation<span class=\"token punctuation\">.</span>FADE <span class=\"token operator\">-></span> it<span class=\"token punctuation\">.</span><span class=\"token function\">setCustomAnimations</span><span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_fade_in<span class=\"token punctuation\">,</span> R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_fade_out<span class=\"token punctuation\">)</span>\n                        StackAnimation<span class=\"token punctuation\">.</span>SLIDE_FROM_RIGHT <span class=\"token operator\">-></span> it<span class=\"token punctuation\">.</span><span class=\"token function\">setCustomAnimations</span><span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_slide_in_from_left<span class=\"token punctuation\">,</span> R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_slide_out_to_right<span class=\"token punctuation\">)</span>\n                        StackAnimation<span class=\"token punctuation\">.</span>SLIDE_FROM_LEFT <span class=\"token operator\">-></span> it<span class=\"token punctuation\">.</span><span class=\"token function\">setCustomAnimations</span><span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_slide_in_from_right<span class=\"token punctuation\">,</span> R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_slide_out_to_left<span class=\"token punctuation\">)</span>\n                        StackAnimation<span class=\"token punctuation\">.</span>SLIDE_FROM_BOTTOM <span class=\"token operator\">-></span> it<span class=\"token punctuation\">.</span><span class=\"token function\">setCustomAnimations</span><span class=\"token punctuation\">(</span>\n                            R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_no_animation_medium<span class=\"token punctuation\">,</span> R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_slide_out_to_bottom\n                        <span class=\"token punctuation\">)</span>\n                        StackAnimation<span class=\"token punctuation\">.</span>FADE_FROM_BOTTOM <span class=\"token operator\">-></span> it<span class=\"token punctuation\">.</span><span class=\"token function\">setCustomAnimations</span><span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_no_animation_250<span class=\"token punctuation\">,</span> R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_fade_to_bottom<span class=\"token punctuation\">)</span>\n                        StackAnimation<span class=\"token punctuation\">.</span>IOS <span class=\"token operator\">-></span> it<span class=\"token punctuation\">.</span><span class=\"token function\">setCustomAnimations</span><span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_slide_in_from_left_ios<span class=\"token punctuation\">,</span> R<span class=\"token punctuation\">.</span>anim<span class=\"token punctuation\">.</span>rns_slide_out_to_right_ios<span class=\"token punctuation\">)</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n\n            <span class=\"token operator\">..</span><span class=\"token punctuation\">.</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이제 진짜 마지막으로 해당 xml 파일을 찾아 duration부분을 수정하고 patch package를 진행해 애니메이션 속도를 변경할 수 있었다.\n기존 duration은 <code class=\"language-text\">config_mediumAnimTime</code>으로 설정되어 있었고, 해당 부분을 수정하면 커스텀하게 수정이 가능하게 되었다.</p>\n<p>animation duration은 react-native-screens에서 20,250,350을 기본 값으로 설정해두고 있는 것으로 보여, 250으로 변경해 적용하게 되었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token comment\">&lt;!--[참고 코드](react-native-screens/android/src/main/res/base/anim/rns_slide_in_from_bottom.xml)--></span>\n<span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"utf-8\"?></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>translate</span> <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>android</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://schemas.android.com/apk/res/android<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>fromYDelta</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>100%<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>toYDelta</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0%<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>duration</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>@android:integer/config_mediumAnimTime<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span> <span class=\"token comment\">&lt;!--250으로 변경 --></span>\n\n<span class=\"token comment\">&lt;!--[참고 코드](react-native-screens/android/src/main/res/base/anim/rns_slide_out_to_bottom.xml)--></span>\n<span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"utf-8\"?></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>translate</span> <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>android</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://schemas.android.com/apk/res/android<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>fromYDelta</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>100%<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>toYDelta</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0%<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>duration</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>@android:integer/config_mediumAnimTime<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span> <span class=\"token comment\">&lt;!--250으로 변경 --></span>\n    \n<span class=\"token comment\">&lt;!--[참고 코드] (react-native-screens/android/src/main/res/base/anim/rns_no_animation_medium.xml)--></span>\n<span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"utf-8\"?></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>alpha</span> <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>android</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://schemas.android.com/apk/res/android<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>fromAlpha</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1.0<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>toAlpha</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1.0<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>duration</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>@android:integer/config_mediumAnimTime<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span> <span class=\"token comment\">&lt;!--250으로 변경 --></span>  </code></pre></div>\n<table>\n  <tbody><tr>\n    <td>개선 전 Android Native Stack Card (slide_from_bottom)</td>\n    <td>개선 후 Android Native Stack Card (slide_from_bottom)</td>\n  </tr>\n  <tr>\n    <td><img src='/static/android-animation-velocity-before-11e1eb9cd9b9fd30d411015f2d4e8f5d.gif' alt='modal' width='300'></td>\n    <td><img src='/static/android-animation-velocity-after-274b86d28ae33248b5cd057696902da0.gif' alt='modal' width='300'></td>\n  </tr>\n</tbody></table>\n<p>시간상 하지 못했지만, 조금 더 모달 애니메이션을 개선하면 좋았을 것 같다는 아쉬운 생각이 들었다.\n기존에는 끝에 점점 천천히 도착하는 듯한 효과가 있었지만 지금은 linear하게 한번에 뜨고 닫히는 것 같아 어색함이 남아있어보였다.\n이후에 더 <code class=\"language-text\">native스러운 느낌</code>을 줄 수 있게 후작업으로 개선 작업도 진행해보려 한다.</p>\n<h4>TransparentModal</h4>\n<p>기존 일부 화면에서 사용되고 있던 <code class=\"language-text\">transparent modal</code> 옵션을 <code class=\"language-text\">containedTransparentModal</code>을 이용해 최대한 사용하려 했지만, 다음 화면이 card인 경우에 애니메이션이 버벅이는 듯한 이슈가 발생하게 되었다.\n이를 해결하기 위해서 <code class=\"language-text\">transparent modal</code> 옵션 대신 기존 화면을 바텀시트 컴포넌트를 이용해 구현하는 방식으로 수정하게 되었다.</p>\n<p>이렇게 수정했을 때 기존은 모달이지만 서서히 fade in/fade out으로 화면전환이 되었지만, 바텀시트로 변경하면서 overlay가 보이는 모달 느낌이 더 들 수 있어 좋은 선택이라 생각이 들었다.</p>\n<p>제품 내 모든 <code class=\"language-text\">transparent modal</code> 옵션을 사용하던 화면들을 다 바꾸지는 못했고, 이슈가 있었던 화면만 수정하게 되었지만, 다음화면에 따라 화면전환 애니메이션에 이슈가 있을 수 있어 후작업을 진행해야할 것 같다.</p>\n<table>\n  <tbody><tr>\n    <td>이슈가 되었던 transparent modal</td>\n    <td>BottomSheet으로 전환한 transparent modal</td>\n  </tr>\n  <tr>\n    <td><img src='/static/signup-modal-issue-before-181402dd96c4b288d4f1eb3f933d4816.gif' alt='modal' width='300'></td>\n    <td><img src='/static/signup-modal-after-6cc3bcf34a11ea634eb2b80b43b1c024.gif' alt='modal' width='300'></td>\n  </tr>\n</tbody></table>\n<h3>기타 이슈: gesture handler로 사진 끌어당겨 닫기 이슈</h3>\n<p>해당 이슈는 첫번째 배포 때 롤백하게 된 가장 컸던 이슈로 이미지 슬라이더를 보고 끌어당겨 해당 화면을 pop한 후에, 제품 내 메인 퍼널 중 하나인 요청서 작성화면에 진입한 경우에 질문이 10개만 렌더링되는 이슈가 발생했다.</p>\n<p>이미지를 끌어당겨 종류할 수 있게 하기 위해 PanResponder를 이용해 구현했는데, PanResponder로 끌어당겨 <code class=\"language-text\">navigation.pop</code>을 진행하게 하는 동작에서 문제가 발생하는 것으로 보였다. </p>\n<p>해당 이슈를 해결하는 과정에서 FlatList로 구현된 요청서 작성화면의 요소가 Flatlist의 <a href=\"https://reactnative.dev/docs/flatlist#initialnumtorender\">initialNumToRender</a> prop의 default 값처럼 딱 10개만 항상 렌더링되는 것을 근거로 <code class=\"language-text\">FlatList</code> 내부 코드를 확인해보게 되었다.</p>\n<p>Flatlist는 VirtualizedList를 상속받아 구현되어 있고, VirtualizedList는 다음 목록을 가져오기 위해서 <a href=\"https://github.com/facebook/react-native/blob/main/packages/virtualized-lists/Interaction/Batchinator.js\">Batchinator</a>를 이용해 다음 목록을 받아오게된다.\n이때 Batchinator는 InteractionManager의 runAfterInteractions 메소드를 이용해 다음 목록을 받아오게 구현되어 있었다.</p>\n<p>[ <a href=\"https://github.com/facebook/react-native/blob/main/packages/virtualized-lists/Interaction/Batchinator.js\">Batchinator 코드</a>]</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Batchinator</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function-variable function\">_callback</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">;</span>\n  _delay<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n  _taskHandle<span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token punctuation\">{</span><span class=\"token function-variable function\">cancel</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token function-variable function\">callback</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">,</span> delayMS<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_delay <span class=\"token operator\">=</span> delayMS<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_callback <span class=\"token operator\">=</span> callback<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">/*\n   * Cleanup any pending tasks.\n   *\n   * By default, if there is a pending task the callback is run immediately. Set the option abort to\n   * true to not call the callback if it was pending.\n   */</span>\n  <span class=\"token function\">dispose</span><span class=\"token punctuation\">(</span>options<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>abort<span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>abort<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_taskHandle<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_taskHandle<span class=\"token punctuation\">.</span><span class=\"token function\">cancel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>options<span class=\"token punctuation\">.</span>abort<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">_callback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_taskHandle <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">schedule</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_taskHandle<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">const</span> timeoutHandle <span class=\"token operator\">=</span> <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_taskHandle <span class=\"token operator\">=</span> InteractionManager<span class=\"token punctuation\">.</span><span class=\"token function\">runAfterInteractions</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// Note that we clear the handle before invoking the callback so that if the callback calls</span>\n        <span class=\"token comment\">// schedule again, it will actually schedule another task.</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_taskHandle <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">_callback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_delay<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_taskHandle <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token function-variable function\">cancel</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">clearTimeout</span><span class=\"token punctuation\">(</span>timeoutHandle<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> Batchinator<span class=\"token punctuation\">;</span></code></pre></div>\n<p>이미지를 끌어당겨 종료하기 위해 사용되는 PanResponder 또한 내부 적으로 InteractionManager를 이용하는데 이때 gesture 방해를 막기위해 JS 이벤트를 blocking하게 구현되어 있다.</p>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/73e4ef2d6b40e56306614a33913aebc7/90694/pan-responder.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 51.764705882352935%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABcUlEQVR42p1S226DMAzd/2vSXvc1+4Y9V5PWdQMCKYVcgRA4s12qFWl7WSRjOzjHx5eHZVkQ4yASYsQ8zxjGEdOUMJIep0n82x3rOFD8MCKlGSFEub+dB/4Ya1GUFepGQ59b1FqjvXSoVCNatx3FDOj6CGNYOxIDa52QyHn5AVzXFdZ59BTgfRDw3hg4svmBtZ5YaGJ7IHnDEA9URUPsFmHIFS2EsWPYG4tze9nALBp9lgTsdyYSy1dU5ROUesbx/RFt+0LMMiW4topBdwwn6lNK3DPS9JN7wkF8N7GQn9IKfpfmlewM7v1Ncs57hpeuh6qbO9EoVY3TZ4GiUtDEuFIKx48TqrrGV1GirGqqqpOKArFct7IFUAZAQDyEolTiO+4rB4cgtiHbUE89+dY5OLKd91Iys9yVzOWxZlk2+e8RQN4ls2XkifOu8Tpwdi8Mg+wd93K9S/ZbXgHkReWB8AMeUM7XdZABbYOZc96V9hfDbx85CALalaGSAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='pan responder 주석' title='' src='/static/73e4ef2d6b40e56306614a33913aebc7/ca1dc/pan-responder.png' srcset='/static/73e4ef2d6b40e56306614a33913aebc7/e7570/pan-responder.png 170w,\n/static/73e4ef2d6b40e56306614a33913aebc7/f46e7/pan-responder.png 340w,\n/static/73e4ef2d6b40e56306614a33913aebc7/ca1dc/pan-responder.png 680w,\n/static/73e4ef2d6b40e56306614a33913aebc7/02d09/pan-responder.png 1020w,\n/static/73e4ef2d6b40e56306614a33913aebc7/90694/pan-responder.png 1318w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>pan responder 주석</figcaption>\n  </figure></p>\n<p>이를 근거로 자세한 동작과 충돌 과정은 파악하지 못했지만 이미지를 끌어당겨 종료하는 이벤트를 처리하는 과정에서 Interaction Manager가 blocking되어 FlatList의 InteractionManager가 동작하지 못하게 막아서 발생하는 이슈로 추측할 수 있었다.</p>\n<p>해당 이슈를 해결하게 위해서 Pan Responder의 interaction 도중에 navigation.pop이 진행되게 하는게 아니라 Interaction이 모두 끝난 후에 진행되게 해 문제를 해결할 수 있었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\">    <span class=\"token keyword\">const</span> panResponder <span class=\"token operator\">=</span> <span class=\"token function\">useRef</span><span class=\"token punctuation\">(</span>\n        PanResponder<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n            <span class=\"token operator\">...</span><span class=\"token punctuation\">,</span>\n            <span class=\"token function-variable function\">onPanResponderGrant</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n                <span class=\"token comment\">// PanGesture가 완료되고 난 이후에 화면 이동을 동작시켜 InteractionManager간 충돌을 막습니다.</span>\n                InteractionManager<span class=\"token punctuation\">.</span><span class=\"token function\">runAfterInteractions</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n                        navigation<span class=\"token punctuation\">.</span><span class=\"token function\">goBack</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">;</span></code></pre></div>\n<h2>⭐️ 적용 후 성능 분석</h2>\n<p>이제 적용 후 성능 분석을 진행한 내용을 정리해보려 한다. 화면 전환간 성능을 개선한다는 목표를 가지고 작업을 진행했다 보니 지표적으로 명확하게 보여줄 방법이 크게 없어 어려움을 느꼈다.</p>\n<p>고민 끝에 정했던 방법은 총 3가지로, 먼저 간단하게 실제 제품 내 메인 퍼널들에 대한 <strong>영상</strong>을 찍어서 전/후 비교를 진행했고, 다음으로 직접적이지는 않지만 애니메이션 처리 과정에 필요한 <strong>CPU 사용량과 memory 사용량</strong>을 보기 위해 android에서 웹의 light house처럼 성능측정을 할 수 있는 <a href=\"https://github.com/bamlab/flashlight\"><strong>flash light</strong></a>을 이용해 메인 퍼널들에 대한 지표를 측정해보았다.\n그리고 추가적으로 화면 stack이 최대 100개가 되었을 때도 정상적으로 애니메이션을 처리할 수 있을지 보기 위해 <strong>stress 테스트</strong>를 진행해보았다.</p>\n<h3>영상을 통한 전/후 비교</h3>\n<p>영상을 통한 전/후 비교는 가장 직관적으로 보여줄 수 있는 방법이라고 생각했다. 영상을 찍어서 전/후 비교를 진행했고, 이를 통해 애니메이션의 자연스러움과 끊김이 있는지, 또한 화면 전환 속도가 빨라졌는지 확인할 수 있었다.</p>\n<p>아래는 메인 퍼널 중 하나인 고객홈 -> 메인 카테고리 까지 넘어가는 과정을 Android (Galaxy22)에서 찍은 영상이다. </p>\n<table>\n  <tbody><tr>\n    <td>AS-IS</td>\n    <td>TO-BE</td>\n  </tr>\n  <tr>\n    <td><img src='/static/customer-home-before-3285aaaa8de548e6f2d2ac7345e7c0bb.gif' alt='modal' width='300'></td>\n    <td><img src='/static/customer-home-after-d001c1aeeb801cc2ad81c3c2aedc1ecf.gif' alt='modal' width='300'></td>\n  </tr>\n</tbody></table>\n<p>영상을 비교해보았을 때 이전보다 조금 더 부드럽게 전환되고 화면전환 이벤트 처리가 빨라진 것을 느낄 수 있었다.</p>\n<h3>FlashLight를 이용한 성능 측정</h3>\n<p>영상을 찍는데에서 끝내지 않고 최대한 숫자로, 지표로 분석해보면 조금 더 좋지 않을까 생각해 flash light를 이용해 성능 측정을 진행해보았다.\nflash light와 maestro e2e 자동화 코드를 이용해 측정해보았고, 앱을 시작해서 위에서 영상으로 찍었던 메인 퍼널 시나리오에 대해 각각 30번 진행했을 때 성능 지표를 측정했다.</p>\n<table width='100%'>\n  <tbody><tr>\n    <th>홈 -&gt; 메인 카테고리 전/후</th>\n  </tr>\n  <tr>\n    <td><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/723ec35d21f76c2a88b3093848ee73c2/ecc47/flashlight-home.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 61.76470588235294%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAAB9UlEQVR42j1TSZLcMAzrH4w37Za8L1mncshUUnPKIW/I/1/CALR7DipZJAQCpPzwqRdjrC43jJKnWeI4ScHuQhDrg7iYpHz9Li4lMSFijzJug+Rlk37bJA6DmBjFIvdwuNDUtbR1I61z0ucsv7BWAKqmuXJdJ+XTF+ytNBXOTSU+GDn7Xn6iSNsiXleINzchPhg0uBgA+rMs8hfVXhDruIyRfH7WnTgu570cwP2bZzkRf2KVsL0JrbWy77v8eHuTRHsowHjXGen384OwQzzGIL/f3+Xb66tEnJu70MM5rwprWONysO2xDC5XODNHgn7dlZiYCrYZcxBggaspqLkJrXWQ72ScJpkhP6N/rOZhaYYlC3JVOK2XdeQnYImn7QEDyeMgbXKaV4WccELvPKaqttB8g+qJLwA7CVOZNEcMsSzEYbFwwNRbbxSnCj36eJynlDJokAqNs7IsqxK0JMyDElDZtu16p4FNko8z1KZLmCokaYH0Ae+QAPaEPSzjeFvmEHrdqbqUosQsEPC82IaEomrZWq+DyAA9+0dgTZUvlTh8E3gRYsf06YT9UyyK+xZvM7onoVNb+37IcRwfCnlhwd8S1PKl8LI8A3fKum567oFfYNlkr/2G5aDeKZ2LRAQyybNaRl4V8vdEPuLRBywq4pk49pz5/4HyNXLtuJ4rAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='modal' title='' src='/static/723ec35d21f76c2a88b3093848ee73c2/ca1dc/flashlight-home.png' srcset='/static/723ec35d21f76c2a88b3093848ee73c2/e7570/flashlight-home.png 170w,\n/static/723ec35d21f76c2a88b3093848ee73c2/f46e7/flashlight-home.png 340w,\n/static/723ec35d21f76c2a88b3093848ee73c2/ca1dc/flashlight-home.png 680w,\n/static/723ec35d21f76c2a88b3093848ee73c2/02d09/flashlight-home.png 1020w,\n/static/723ec35d21f76c2a88b3093848ee73c2/9d567/flashlight-home.png 1360w,\n/static/723ec35d21f76c2a88b3093848ee73c2/ecc47/flashlight-home.png 2082w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>modal</figcaption>\n  </figure></td>\n  </tr>\n <tr>\n    <th>받은 요청 목록 -&gt; 받은 요청 상세 전/후</th>\n  </tr>\n  <tr>\n    <td><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/b7b10ef10ed71885ce005986750acefd/0c0fb/flashlight-request.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 59.411764705882355%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAAB9ElEQVR42k1Sy27bQBDzB7RoJe1bWkkrPxL3kkMSAwF6L1D03v//EpYcK2kOa49mORxydg6pjggpwo8J00PDemqYzpv9B+Z8SRivzP3gN2Ph1nlBOx8xErMcN0TlyZGmgoPIhq7DMPTwOWErI16niYCEvu/Rfe+QtwnlVC1WLrqAWgpuxE0pW04cPngSkmRQYhjgvcfl8RF/Tye8OocvzA1dj9xIeKzouzvO8a6uK35fr/jFxt+EI4ePYVfY30GBHV7e3vDz6Qk3kn9VsQgXEq7Vitze+IFkt+dn/MnZcv0HYYzoKLcz2wSTOIaAbgfpaM4ilULhlHMkLTzJDejkkKI86w7OB5RxxNoa2rZZLMDE+czzzCaOwyZhneggorXNsLoPMWFeVviJKunOk+ugn8Q51DojEeCcN6U5FxZVI4xjQeLRnXC6UxyoSN+FLr3bCd9B5/MZhS8nKz0JpXTh4AeNgAR22PByuWCq1XCyuK4No9aGCp0RahZcFVkRQbI1uCtUI1PInI7mLbsiUY0UCeOrLIddIQkzlWleI1VJnXKaY+QDOE/CmE1dJKFwlQqlXNik/SvhEyEvNKsTLR+5f5HztEdhUaMas2xkye6E09FI1LhRbVoYR2/rdHjvnmhRdhXrNS0nm4xlP+fxI/6Mszj9r/kHCus11NPB6dUAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='modal' title='' src='/static/b7b10ef10ed71885ce005986750acefd/ca1dc/flashlight-request.png' srcset='/static/b7b10ef10ed71885ce005986750acefd/e7570/flashlight-request.png 170w,\n/static/b7b10ef10ed71885ce005986750acefd/f46e7/flashlight-request.png 340w,\n/static/b7b10ef10ed71885ce005986750acefd/ca1dc/flashlight-request.png 680w,\n/static/b7b10ef10ed71885ce005986750acefd/02d09/flashlight-request.png 1020w,\n/static/b7b10ef10ed71885ce005986750acefd/9d567/flashlight-request.png 1360w,\n/static/b7b10ef10ed71885ce005986750acefd/0c0fb/flashlight-request.png 2150w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>modal</figcaption>\n  </figure></td>\n  </tr>\n <tr>\n    <th>받은 견적 목록 -&gt; 받은 견적 상세 -&gt; 견적서 상세 전/후</th>\n  </tr>\n  <tr>\n    <td><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/fee7c2069cf95c62c3954c77b659d036/e249b/flashlight-quote.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 58.235294117647065%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAAB8ElEQVR42k1Ty3LbMAzUF3Qqim9SFG1Z9iSd+NJLx6cecuw9//8lmwUkJz1gRBCLxS5oDykFxBjQe8B1W9DXjvN2wrIUlOJRa8D9vuB8zpqXOWDZGlbi+oWxVKTkD46CwRiDcTTwziDmhHup+FUKRmshNYmXlxk5e4w/R5jJYGLzSszvWjE5h51jRC0RwzRNeEZICY/XV/ybZzjm5ri/3XZCaZTcO4/b9YqPdcWbs/ghONZKSTuhpRqJRqK/7+84nU7wovAg3LZZbT2x3nv8eTzwdr8jHzhjpm9CkSvhKN9LsEHyp/J15Z6i/8KpSmIEr0PNpOozVzZYXi698xG6fh3tOIJFZeQKzGR5rgjBI3O/nfeCSymjtYbSKmwJHGIVP0yUXLncWmc2RS1Y6zDPjU1J88YmT0JpEJIYk2ISv4VrsvkgjKKQhOt60anes8BcorWFiorak4FibybZerko8aS7DGi9wc5RdyuCBpm02z0pieTfCrNOFmJZTVHLZ8X6EJRwXha4ErVnJyRQ7AqBAPTFZDp/c0nOrKdUdLc5F+L44jkrzvIhkhl3y18K2SCWL9umC39a7lyBWJXGRCJRIA627aq25eEKlfdzh23/WZbJYk1ClqqvfNyFkA5lfBQftUFUSk3cRNbl7PjPEVyMGZ9+fzX+sSCfvAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='modal' title='' src='/static/fee7c2069cf95c62c3954c77b659d036/ca1dc/flashlight-quote.png' srcset='/static/fee7c2069cf95c62c3954c77b659d036/e7570/flashlight-quote.png 170w,\n/static/fee7c2069cf95c62c3954c77b659d036/f46e7/flashlight-quote.png 340w,\n/static/fee7c2069cf95c62c3954c77b659d036/ca1dc/flashlight-quote.png 680w,\n/static/fee7c2069cf95c62c3954c77b659d036/02d09/flashlight-quote.png 1020w,\n/static/fee7c2069cf95c62c3954c77b659d036/9d567/flashlight-quote.png 1360w,\n/static/fee7c2069cf95c62c3954c77b659d036/e249b/flashlight-quote.png 2192w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>modal</figcaption>\n  </figure></td>\n  </tr>\n <tr>\n    <th>채팅방 목록 -&gt; 채팅방 AS-IS</th>\n  </tr>\n  <tr>\n    <td><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/a83ade7021bc8fb866dcdfaeee82b222/8077d/flashlight-chatlist.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 58.82352941176471%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAAB9ElEQVR42k1SW27cMBDbC7SNLVtvyfIjXqQo9iNdoMhPjhD0/peZkqNN2w8Z0ojkcChfQk3igsPy4mqUfK6StlV8ieJyEJuC5O+bLu5tCVJqkbajtq+SWxUbvfKpdbHeyTAMMo6jPE1G1pzkHpMMOLM2fHuSuFUJW8G+46yZpYYkr8B5azsWGjO0IOgVZIwRh8tjP+SjNfmB/VfUzDBCsEhcC0gdN88QXFf5fb3KO/hfUJvYCC7VocFhmiYV/Hm/y/PLi3iQSKZIbEVC64LEWdzdbjf59fYmDYLEUYPmLta5PtrDpYWoR03FdJQR2WRdjOZ/HJ2OaDB+CoJ3mXERY5SGEdZt0z2JpRSpywKgkVCQFbJ1IBDDlVKSEII0xFOtU+fzp6BzXnLJ2sGwIx6H+5SyuvEp6qKjjEYeQsSRmzJ4ofMshC/T1EHP56mXE8eASAhw3VYFeuwdRLwPcp5XqXVRHAU5mV2iTBbn2cIhPgRyvFqrOAQ7qGDQsUaDx8I9p6DrAswCrAeOogUmZvyHZu6OVTAgtwVZZFxqwLhkyIEPMP8T5FqWpqI9GrhH3jZa4B4O2YWjcuT9OJQ04GVLqRo+iXTNusd/dgBzAstILAS2fReHkdUhBdmdo6gL38fqZ681/h4kBx819I4jx//l2QeP0f0BdJU06APYMHQAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='modal' title='' src='/static/a83ade7021bc8fb866dcdfaeee82b222/ca1dc/flashlight-chatlist.png' srcset='/static/a83ade7021bc8fb866dcdfaeee82b222/e7570/flashlight-chatlist.png 170w,\n/static/a83ade7021bc8fb866dcdfaeee82b222/f46e7/flashlight-chatlist.png 340w,\n/static/a83ade7021bc8fb866dcdfaeee82b222/ca1dc/flashlight-chatlist.png 680w,\n/static/a83ade7021bc8fb866dcdfaeee82b222/02d09/flashlight-chatlist.png 1020w,\n/static/a83ade7021bc8fb866dcdfaeee82b222/9d567/flashlight-chatlist.png 1360w,\n/static/a83ade7021bc8fb866dcdfaeee82b222/8077d/flashlight-chatlist.png 2190w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>modal</figcaption>\n  </figure></td>\n  </tr>\n</tbody></table>\n<p>성능 지표를 분석해보았을 때 퍼널 별로 오르락 내리락 하는 부분들이 있지만, CPU 사용량과 Memory 사용량이 대부분 감소했고 이는 <strong>애니메이션 처리 과정에서 더 효율적으로 처리되고 있다</strong>는 것을 의미한다고 볼 수 있었다.</p>\n<p>그리고 추가적으로 분석해보았을 때 받은견적 목록 -> 받은 견적 상세 -> 견적서 상세 전환에서 다른 퍼널과 다르게 전체적인 지표 모두 좋아진 것을 볼 수 있었다.\n퍼널간 차이점을 보았을 때 측정했던 퍼널 중 가장 긴 퍼널이었다는 점을 고려해 Navigation stack이 쌓일수록 더 효율적으로 처리하고 있다는 것을 알 수 있었다.</p>\n<p>이러한 특징을 눈으로 더 명확하게 확인해보기 위해서 <code class=\"language-text\">Navigation stack이 100개가 되었을 때도 성능이 좋아지는지</code> 확인해보는 건 어떨까라는 호기심이 생겨 stress 테스트를 이어서 진행해보았다.</p>\n<h3>Stress 테스트를 통한 성능 확인</h3>\n<p>stress 테스트는 10개, 30개, 50개, 75개, 100개 까지 stack에 화면이 쌓였을 때 어떻게 화면전환이 되는지를 촬영해보았고, 영상 상단에 navigation stack의 길이를 표시해 현재 몇개 stack이 쌓였는지 확인할 수 있게 했다.\n아래 영상은 Android Galaxy22 기기에서 측정한 결과다.</p>\n<table width='100%'>\n <tbody><tr>\n    <th>Stack Navigator 10개 </th>\n    <th>Stack Navigator 50개 </th>\n    <th>Stack Navigator 100개 </th>\n  </tr>\n <tr>\n    <td><img src='/static/android-before-10-cb36866397ec48dd51609d22df1c6559.gif' alt='modal' width='300'></td>\n    <td><img src='/static/android-before-50-52d6fe0878649772fda3c96118686eb4.gif' alt='modal' width='300'></td>\n    <td><img src='/static/android-before-100-976fd0917532e931400b835b3521c3eb.gif' alt='modal' width='300'></td>\n </tr>\n <tr>\n    <th>Native Stack Navigator 10개 </th>\n    <th>Native Stack Navigator 50개 </th>\n    <th>Native Stack Navigator 100개 </th>\n  </tr>\n <tr>\n    <td><img src='/static/android-after-10-26e44a3e8675d32385b679082feb02b9.gif' alt='modal' width='300'></td>\n    <td><img src='/static/android-after-50-2511bebeb42f8d97b2415d8adca1f325.gif' alt='modal' width='300'></td>\n    <td><img src='/static/android-after-100-a70aceb52dfd431a9ef95f6ceeff34bb.gif' alt='modal' width='300'></td>\n </tr>\n</tbody></table>\n<p>Stack Navigator는 stack이 쌓일수록 화면전환 속도가 느려지는 것을 확인할 수 있었고, Native Stack Navigator는 stack이 쌓여도 유사한 속도로 화면전환이 진행되는 것을 볼 수 있었다.</p>\n<p>촬영과정에서 기기에서 느껴지는 발열도 Native Stack Navigator가 더 낮은 것을 느낄 수 있었고, 이는 CPU 사용량과 Memory 사용량이 줄어들어 성능이 향상되었다는 것을 체감할 수 있었다.</p>\n<h2>📚 배운점</h2>\n<p>여태까지 진행했던 프로젝트 중에서 가장 이슈가 많았던 작업이었고, 다행히 잘 해결해서 현재 잘 제품에 반영되어 있어 뿌듯했다.</p>\n<p>단순 Javascript 런타임만 고민하는게 아니라 모바일 플랫폼에 특화된 성능 개선을 적용할 수 있어 좋았고, 잘 만들어진 오픈 소스 라이브러리들을 내부구조도 파헤치는 좋은 경험이 되어 이후에 React Navigation에도 기여하고 싶은 마음도 생겼다.</p>\n<p>적용하면서 성능이 개선되었는지 확인하기 위해 다양한 방법을 사용해보았는데, 영상을 찍어 전/후 비교를 하는 것이 가장 직관적이었다. 나름 숫자로 표현하기 위해 노력해보았지만 어느정도 한계가 있었다.\n하지만, 메모리나 CPU 사용량과 같이 이전에 관심을 두지 않았던 하드웨어 스펙에 대해서도 관심을 가지게 되었고, 이를 통해 성능을 개선하는데 도움이 되었다.</p>\n<p>물론 여전히 남겨진 일들이 있지만, 하나의 또 큰 일감을 잘 마무리하고 사용자 경험과 성능 모두 개선할 수 있었던 좋은 작업이었다고 생각되었다.</p>","frontmatter":{"title":"🖥️ Native Stack 적용하기","date":"July 06, 2024","tags":["회고","react-navigation","react-native","성능"],"series":null},"fields":{"slug":"/2024-06-30-NativeStack적용하기/","readingTime":{"minutes":36.875}}},"seriesList":{"edges":[{"node":{"id":"db12bfaf-9b68-5456-b2d3-bf7af6db01f6","fields":{"slug":"/2022-09-06-BEM과-자료형/"},"frontmatter":{"title":"BEM과 자바스크립트의 자료형"}}},{"node":{"id":"11c1a396-7281-552a-9589-6f14d399473b","fields":{"slug":"/2022-09-07-자바스크립트의-타입과연산자/"},"frontmatter":{"title":"자바스크립트의 타입과 연산자"}}},{"node":{"id":"1b75d916-f93f-54a4-bcb0-ee6a88e1e807","fields":{"slug":"/2022-09-07-자바스트립트의-두가지-복사방법/"},"frontmatter":{"title":"자바스크립트의 두가지 복사 방법"}}},{"node":{"id":"3b564afa-9e11-5817-9130-4e2a191f4dff","fields":{"slug":"/2022-09-10-intersection-observer /"},"frontmatter":{"title":"Intersection observer"}}},{"node":{"id":"ac0c72d8-87ec-5038-8d94-316c5fcc3d62","fields":{"slug":"/2022-09-12-브라우저API/"},"frontmatter":{"title":"Browser API"}}},{"node":{"id":"362a634b-e650-5526-851e-d5fbd908dab8","fields":{"slug":"/2022-09-13-함수/"},"frontmatter":{"title":"함수"}}},{"node":{"id":"fa488a20-ff1a-5d21-a871-7cd7a1943bb7","fields":{"slug":"/2022-09-14-객체/"},"frontmatter":{"title":"객체"}}},{"node":{"id":"93e28849-ee68-5f54-a013-82287b705626","fields":{"slug":"/2022-09-17-빌트인객체/"},"frontmatter":{"title":"빌트인 객체"}}},{"node":{"id":"792817ac-87f4-5be2-a7aa-360f10d5c8b4","fields":{"slug":"/2022-09-19-array/"},"frontmatter":{"title":"Array"}}},{"node":{"id":"b9665749-4456-51bc-8980-7b1df634660e","fields":{"slug":"/2022-09-22-iteration/"},"frontmatter":{"title":"Iteration"}}},{"node":{"id":"b36e6692-59b2-579e-a86a-a032da431840","fields":{"slug":"/2022-09-24-Map과Set/"},"frontmatter":{"title":"Map과 Set"}}},{"node":{"id":"483fabc0-6bc7-5db7-9654-84987635add6","fields":{"slug":"/2022-10-06-HTTP란/"},"frontmatter":{"title":"HTTP 정리"}}},{"node":{"id":"197d4909-e862-5b9a-8676-b53e027e5379","fields":{"slug":"/2022-10-18-Node-JS-기초/"},"frontmatter":{"title":"Node js:NodeJS 이용한 서버 만들기"}}},{"node":{"id":"bd10a339-6c06-5837-862e-192c45081282","fields":{"slug":"/2022-10-19-Express-기초/"},"frontmatter":{"title":"NodeJS: express"}}},{"node":{"id":"8195c683-dc7e-58d3-b7b6-c5a1e78b6522","fields":{"slug":"/2022-11-18-CSR과-SSR/"},"frontmatter":{"title":"CSR과 SSR 그리고 Universal Rendering"}}},{"node":{"id":"f05c2eb8-16da-5e6e-a906-bbdffa05ace6","fields":{"slug":"/2022-11-20-스코프-실행컨테스트-클로저/"},"frontmatter":{"title":"스코프,실행컨텍스트,클로저"}}},{"node":{"id":"24ec8ed8-dfae-5619-8c64-df914805c0eb","fields":{"slug":"/2022-11-24-Critical-Rendering-Path/"},"frontmatter":{"title":"💻 Critical Rendering Path"}}},{"node":{"id":"c32a9017-54df-5eb4-98cd-5eba4b9ae41c","fields":{"slug":"/2022-11-27-비동기와-프로미스/"},"frontmatter":{"title":"비동기와 프로미스"}}},{"node":{"id":"364cb56c-45fc-52dc-8311-0f61a88dfdfe","fields":{"slug":"/2022-11-30-지스트-청원-서비스-회고/"},"frontmatter":{"title":"지스트 청원서비스 회고"}}},{"node":{"id":"40c2d20c-04f0-5876-aee6-be5b43bce78a","fields":{"slug":"/2022-12-02-제너레이터와-async-await/"},"frontmatter":{"title":"제너레이터와 Async-Await"}}},{"node":{"id":"4ed9db58-39c3-5f21-ad1e-59be0b94e988","fields":{"slug":"/2022-12-03-모으잡-리팩토링/"},"frontmatter":{"title":"모으잡-check box 수정, react-query 커스텀 훅, 크롤링 이슈"}}},{"node":{"id":"937a4bc1-5318-52a9-b6fd-61188127ce23","fields":{"slug":"/2022-12-05-호이스팅/"},"frontmatter":{"title":"호이스팅"}}},{"node":{"id":"09bdd07c-e41f-573e-bd66-71c526ab83f8","fields":{"slug":"/2022-12-09-쿠키-session-jwt/"},"frontmatter":{"title":"Cookie,Session과 JWT"}}},{"node":{"id":"b552cf79-29a8-5e87-a162-c03661121fb6","fields":{"slug":"/2022-12-09-this/"},"frontmatter":{"title":"this"}}},{"node":{"id":"05a00e19-f52a-5596-a97e-4f7390b20119","fields":{"slug":"/2022-12-10-http와https/"},"frontmatter":{"title":"http와 https"}}},{"node":{"id":"b91bff56-be62-5318-b6f1-dc3ddc789d08","fields":{"slug":"/2022-12-12-생성자함수-프로토타입/"},"frontmatter":{"title":"생성자 함수, 프로토타입"}}},{"node":{"id":"3b7d6329-680d-5db9-8ee6-cb15da44b6a8","fields":{"slug":"/2022-12-30-이벤트/"},"frontmatter":{"title":"이벤트"}}},{"node":{"id":"a94c02b8-45b0-5fac-b129-cf99c64a8f24","fields":{"slug":"/2022-12-23-class/"},"frontmatter":{"title":"클래스"}}},{"node":{"id":"d1dc9a50-2824-5859-826f-ceb445994e93","fields":{"slug":"/2023-01-23-리액트의-기본원리/"},"frontmatter":{"title":"React study: 리액트의 기본 원리"}}},{"node":{"id":"8dd5dd72-0262-582e-8a1d-33fd6b2245f3","fields":{"slug":"/2023-01-23-Vite와-번들러/"},"frontmatter":{"title":"Vite는 왜 빠를까, 번들러에 대한 정리"}}},{"node":{"id":"2cd6faf4-d340-58ee-a4bc-c4b16bc21c42","fields":{"slug":"/2022-12-20-리액트-성능보장/"},"frontmatter":{"title":"React study: 리액트가 성능을 보장하는 방법"}}},{"node":{"id":"717eb8fb-45a2-5fef-aaa9-c5c5eceb792a","fields":{"slug":"/2023-02-03-useState,useEffect, useRef, memo/"},"frontmatter":{"title":"React Study: useState, useEffect, useRef, memo"}}},{"node":{"id":"26ed4c76-848a-56e4-ae68-7e879e23bf77","fields":{"slug":"/2023-02-17-취업준비-회고/"},"frontmatter":{"title":"신입으로 시작하며 작성하는 취준 회고"}}},{"node":{"id":"166ce257-9146-51aa-a470-57c257844c07","fields":{"slug":"/2023-02-21-google.com-입력했을때-일어나는-일/"},"frontmatter":{"title":"google.com를 브라우저에 검색했을 때 일어나는 일"}}},{"node":{"id":"aaa88fe5-37a4-5ff4-9de2-959da89dcd86","fields":{"slug":"/2023-03-01-CDN/"},"frontmatter":{"title":"CDN은 뭘까?"}}},{"node":{"id":"f2fa5329-7ce4-5a65-9e28-0e4b1d188a6c","fields":{"slug":"/2023-03-05-디자인패턴/"},"frontmatter":{"title":"MVC, MVVM, Flux패턴 그리고 Service와 Repository 패턴"}}},{"node":{"id":"543681af-5db3-518d-b19e-7668efdda7fc","fields":{"slug":"/2023-03-31-2023년-3월회고/"},"frontmatter":{"title":"🐤 2023년 3월 회고"}}},{"node":{"id":"eecd0175-5be8-556d-a36a-756d4af0700b","fields":{"slug":"/2023-05-06-2023년-4월회고/"},"frontmatter":{"title":"😎 2023년 4월 회고"}}},{"node":{"id":"055d38ec-e2c0-5a63-aa95-fbc147365d29","fields":{"slug":"/2023-06-05-2023년-5월회고/"},"frontmatter":{"title":"☀︎ 2023년 5월 회고"}}},{"node":{"id":"32156a84-756c-50c3-bd9f-77b3dc2e7547","fields":{"slug":"/2023-07-06-2023년-6월회고/"},"frontmatter":{"title":"☼ 2023년 6월 회고"}}},{"node":{"id":"5438a45e-764a-5e14-b5ba-b71f4ba8be23","fields":{"slug":"/2023-08-09-2023년-7월회고/"},"frontmatter":{"title":"☂︎ 2023년 7월 회고"}}},{"node":{"id":"7a788f0b-75af-5eac-b509-fd0d3f119d98","fields":{"slug":"/2023-09-09-2023년-8월회고/"},"frontmatter":{"title":"😊 2023년 8월 회고"}}},{"node":{"id":"d47fe7ea-21c5-5c88-b64e-e34021957c29","fields":{"slug":"/2023-10-03-2023년-9월회고/"},"frontmatter":{"title":"🚅 2023년 9월 회고"}}},{"node":{"id":"4268b04a-703c-5bd0-8081-e900ee0ce15c","fields":{"slug":"/2023-11-01-2023년-10월회고/"},"frontmatter":{"title":"🧐 2023년 10월 회고"}}},{"node":{"id":"01c028b9-d56c-52a8-8719-eb5cbcf6ea70","fields":{"slug":"/2023-12-02-2023년-11월회고/"},"frontmatter":{"title":"😃 2023년 11월 회고"}}},{"node":{"id":"e696cf5b-451a-5fe0-a2cb-100a22d3d356","fields":{"slug":"/2023-12-31-2023년-12월회고/"},"frontmatter":{"title":"🌟 2023년 12월 회고"}}},{"node":{"id":"b0eb4259-0e5c-53fd-9fdc-cd5e53336653","fields":{"slug":"/2024-02-07-2024년-1월회고/"},"frontmatter":{"title":"🐥 2024년 1월회고"}}},{"node":{"id":"e7e95438-a61a-5b79-b114-ba3d8026517d","fields":{"slug":"/2024-03-02-2024년-2월회고/"},"frontmatter":{"title":"🙊 2024년 2월회고"}}},{"node":{"id":"1bc07ca5-bb4e-5644-a20e-a011d944706b","fields":{"slug":"/2024-03-03-자바스크립트의-동시성-이해하기/"},"frontmatter":{"title":"Promise.all의 동시성 이해하기"}}},{"node":{"id":"bb2429ab-4ef6-53ad-950b-f49dae0134da","fields":{"slug":"/2024-03-30-App-StartUp-time-개선/"},"frontmatter":{"title":"App StartUp time 개선"}}},{"node":{"id":"a20bddb0-3f08-5708-81e9-73695d6250c7","fields":{"slug":"/2024-04-07-2024년-3월회고/"},"frontmatter":{"title":"🙌 2024년 3월회고"}}},{"node":{"id":"1e59eab7-ece6-5711-97f8-273322a2644b","fields":{"slug":"/2024-04-21-onViewableItemsChanged-이해해보기/"},"frontmatter":{"title":"👀 onViewableItemsChanged 이해해보기"}}},{"node":{"id":"a96d70dd-918a-592f-b9a9-4300903c6dd2","fields":{"slug":"/2024-05-01-2024년-4월회고/"},"frontmatter":{"title":"🙌 2024년 4월회고"}}},{"node":{"id":"4b7beeac-e53e-56b2-b35c-a77e998edb64","fields":{"slug":"/2024-06-01-2024년-5월회고/"},"frontmatter":{"title":"🙌 2024년 5월회고"}}},{"node":{"id":"2fd67da4-b9da-54bb-8fac-9974572e6e56","fields":{"slug":"/2024-06-02-에러바운더리-도입하기/"},"frontmatter":{"title":"✅ 에러바운더리 도입하기"}}},{"node":{"id":"976d3bb5-2ac5-5164-9e34-ecda451f70f4","fields":{"slug":"/2024-06-30-2024년-6월회고/"},"frontmatter":{"title":"🤭 2024년 6월회고"}}},{"node":{"id":"f326c8c4-4a20-548d-86bf-35bd5ed917e0","fields":{"slug":"/2024-06-30-NativeStack적용하기/"},"frontmatter":{"title":"🖥️ Native Stack 적용하기"}}}]},"previous":{"fields":{"slug":"/2024-06-30-2024년-6월회고/"},"frontmatter":{"title":"🤭 2024년 6월회고"}},"next":null},"pageContext":{"id":"f326c8c4-4a20-548d-86bf-35bd5ed917e0","series":null,"previousPostId":"976d3bb5-2ac5-5164-9e34-ecda451f70f4","nextPostId":null}},"staticQueryHashes":[],"slicesMap":{}}